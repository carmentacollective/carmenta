@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * Holographic Dream Theme
 *
 * Design tokens and utility classes for Carmenta's visual language.
 * No !important hacks - we use headless primitives instead of fighting
 * pre-styled components.
 */

@layer base {
    :root {
        /* Background & Surface */
        --background: 320 20% 97%; /* #F8F4F8 */
        --foreground: 285 25% 31%;

        --card: 0 0% 100%;
        --card-foreground: 285 25% 31%;

        --popover: 0 0% 100%;
        --popover-foreground: 285 25% 31%;

        /* Primary - Royal Purple */
        --primary: 270 40% 56%;
        --primary-foreground: 0 0% 100%;

        /* Secondary */
        --secondary: 280 20% 95%;
        --secondary-foreground: 285 25% 31%;

        /* Muted */
        --muted: 280 20% 92%;
        --muted-foreground: 285 20% 50%;

        /* Accent */
        --accent: 280 30% 88%;
        --accent-foreground: 285 25% 31%;

        /* Destructive */
        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        /* Borders & Inputs */
        --border: 280 20% 85%;
        --input: 280 20% 90%;
        --ring: 270 40% 56%;

        /* Border radius */
        --radius: 0.75rem;

        /* Glassmorphism - purple tinted for holo theme */
        --glass-blur: 24px;
        --glass-bg: rgba(196, 163, 212, 0.25);
        --glass-bg-hover: rgba(196, 163, 212, 0.35);
        --glass-bg-active: rgba(196, 163, 212, 0.45);
        --glass-surface: rgba(255, 255, 255, 0.9);
        --glass-shadow: 0 4px 16px rgba(139, 102, 184, 0.15);

        /* Chat viewport fade - Apple-level subtle fades
         * Uses fixed pixels, not percentages, for consistent subtlety
         * Top fade: hint that content exists above
         * Bottom fade: slightly larger to transition into input dock area */
        --chat-fade-top: 40px;
        --chat-fade-bottom: 56px;
    }

    /* Dark mode - Deep purple twilight with holographic shimmer */
    .dark {
        --background: 280 30% 8%;
        --foreground: 280 20% 90%;

        --card: 280 30% 12%;
        --card-foreground: 280 20% 90%;

        --popover: 280 30% 10%;
        --popover-foreground: 280 20% 90%;

        --primary: 270 50% 65%;
        --primary-foreground: 270 30% 8%;

        --secondary: 280 20% 20%;
        --secondary-foreground: 280 20% 90%;

        --muted: 280 20% 18%;
        --muted-foreground: 280 15% 60%;

        --accent: 280 25% 20%;
        --accent-foreground: 280 20% 90%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 280 20% 25%;
        --input: 280 20% 20%;
        --ring: 270 50% 65%;

        /* Royal purple glassmorphism for dark mode */
        --glass-bg: rgba(139, 102, 184, 0.15);
        --glass-bg-hover: rgba(139, 102, 184, 0.25);
        --glass-bg-active: rgba(139, 102, 184, 0.3);
        --glass-surface: rgba(30, 20, 35, 0.95);
        --glass-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    /* ===== WARM EARTH THEME ===== */
    /* Terracotta, sage, and gold - warm and grounded */
    :root[data-theme="warm-earth"] {
        --background: 30 25% 95%;
        --foreground: 25 35% 25%;

        --card: 0 0% 100%;
        --card-foreground: 25 35% 25%;

        --popover: 0 0% 100%;
        --popover-foreground: 25 35% 25%;

        --primary: 15 60% 60%; /* Terracotta */
        --primary-foreground: 0 0% 100%;

        --secondary: 80 30% 85%; /* Sage */
        --secondary-foreground: 25 35% 25%;

        --muted: 30 20% 90%;
        --muted-foreground: 25 25% 45%;

        --accent: 40 50% 65%; /* Gold */
        --accent-foreground: 25 35% 25%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 30 20% 82%;
        --input: 30 20% 88%;
        --ring: 15 60% 60%;

        /* Glassmorphism - terracotta tinted */
        --glass-bg: rgba(200, 120, 80, 0.2);
        --glass-bg-hover: rgba(200, 120, 80, 0.3);
        --glass-bg-active: rgba(200, 120, 80, 0.4);
        --glass-surface: rgba(255, 250, 240, 0.9);
        --glass-shadow: 0 4px 16px rgba(200, 120, 80, 0.15);
    }

    :root[data-theme="warm-earth"].dark {
        --background: 25 30% 10%;
        --foreground: 30 20% 88%;

        --card: 25 25% 14%;
        --card-foreground: 30 20% 88%;

        --popover: 25 30% 12%;
        --popover-foreground: 30 20% 88%;

        --primary: 15 65% 58%;
        --primary-foreground: 25 30% 10%;

        --secondary: 80 20% 22%;
        --secondary-foreground: 30 20% 88%;

        --muted: 25 20% 18%;
        --muted-foreground: 30 15% 58%;

        --accent: 40 55% 55%;
        --accent-foreground: 25 30% 10%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 25 20% 24%;
        --input: 25 20% 20%;
        --ring: 15 65% 58%;

        --glass-bg: rgba(200, 120, 80, 0.15);
        --glass-bg-hover: rgba(200, 120, 80, 0.25);
        --glass-bg-active: rgba(200, 120, 80, 0.3);
        --glass-surface: rgba(35, 25, 20, 0.95);
        --glass-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    /* ===== ARCTIC CLARITY THEME ===== */
    /* Ice blue precision - cool and clear */
    :root[data-theme="arctic-clarity"] {
        --background: 200 30% 96%;
        --foreground: 210 30% 25%;

        --card: 0 0% 100%;
        --card-foreground: 210 30% 25%;

        --popover: 0 0% 100%;
        --popover-foreground: 210 30% 25%;

        --primary: 200 70% 55%; /* Ice blue */
        --primary-foreground: 0 0% 100%;

        --secondary: 200 25% 90%;
        --secondary-foreground: 210 30% 25%;

        --muted: 200 20% 92%;
        --muted-foreground: 210 20% 48%;

        --accent: 190 60% 65%; /* Aqua */
        --accent-foreground: 210 30% 25%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 200 20% 84%;
        --input: 200 20% 90%;
        --ring: 200 70% 55%;

        /* Glassmorphism - ice blue tinted */
        --glass-bg: rgba(100, 180, 220, 0.2);
        --glass-bg-hover: rgba(100, 180, 220, 0.3);
        --glass-bg-active: rgba(100, 180, 220, 0.4);
        --glass-surface: rgba(240, 250, 255, 0.9);
        --glass-shadow: 0 4px 16px rgba(100, 180, 220, 0.15);
    }

    :root[data-theme="arctic-clarity"].dark {
        --background: 210 40% 8%;
        --foreground: 200 25% 88%;

        --card: 210 35% 12%;
        --card-foreground: 200 25% 88%;

        --popover: 210 40% 10%;
        --popover-foreground: 200 25% 88%;

        --primary: 200 75% 60%;
        --primary-foreground: 210 40% 8%;

        --secondary: 210 25% 20%;
        --secondary-foreground: 200 25% 88%;

        --muted: 210 20% 18%;
        --muted-foreground: 200 20% 60%;

        --accent: 190 65% 58%;
        --accent-foreground: 210 40% 8%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 210 20% 24%;
        --input: 210 20% 20%;
        --ring: 200 75% 60%;

        --glass-bg: rgba(100, 180, 220, 0.15);
        --glass-bg-hover: rgba(100, 180, 220, 0.25);
        --glass-bg-active: rgba(100, 180, 220, 0.3);
        --glass-surface: rgba(15, 25, 35, 0.95);
        --glass-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    /* ===== FOREST WISDOM THEME ===== */
    /* Natural green and amber - organic and grounded */
    :root[data-theme="forest-wisdom"] {
        --background: 80 20% 95%;
        --foreground: 140 30% 22%;

        --card: 0 0% 100%;
        --card-foreground: 140 30% 22%;

        --popover: 0 0% 100%;
        --popover-foreground: 140 30% 22%;

        --primary: 140 45% 45%; /* Forest green */
        --primary-foreground: 0 0% 100%;

        --secondary: 80 25% 88%;
        --secondary-foreground: 140 30% 22%;

        --muted: 80 20% 90%;
        --muted-foreground: 140 20% 42%;

        --accent: 35 60% 60%; /* Amber */
        --accent-foreground: 140 30% 22%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 80 20% 82%;
        --input: 80 20% 88%;
        --ring: 140 45% 45%;

        /* Glassmorphism - forest green tinted */
        --glass-bg: rgba(100, 160, 120, 0.2);
        --glass-bg-hover: rgba(100, 160, 120, 0.3);
        --glass-bg-active: rgba(100, 160, 120, 0.4);
        --glass-surface: rgba(245, 250, 240, 0.9);
        --glass-shadow: 0 4px 16px rgba(100, 160, 120, 0.15);
    }

    :root[data-theme="forest-wisdom"].dark {
        --background: 140 25% 10%;
        --foreground: 80 22% 88%;

        --card: 140 22% 14%;
        --card-foreground: 80 22% 88%;

        --popover: 140 25% 12%;
        --popover-foreground: 80 22% 88%;

        --primary: 140 50% 50%;
        --primary-foreground: 140 25% 10%;

        --secondary: 140 18% 22%;
        --secondary-foreground: 80 22% 88%;

        --muted: 140 18% 18%;
        --muted-foreground: 80 18% 58%;

        --accent: 35 65% 58%;
        --accent-foreground: 140 25% 10%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 140 18% 24%;
        --input: 140 18% 20%;
        --ring: 140 50% 50%;

        --glass-bg: rgba(100, 160, 120, 0.15);
        --glass-bg-hover: rgba(100, 160, 120, 0.25);
        --glass-bg-active: rgba(100, 160, 120, 0.3);
        --glass-surface: rgba(20, 30, 25, 0.95);
        --glass-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    /* ===== MONOCHROME THEME ===== */
    /* Charcoal, silver, and cyan accent - minimal and precise */
    :root[data-theme="monochrome"] {
        --background: 0 0% 98%;
        --foreground: 0 0% 23%;

        --card: 0 0% 100%;
        --card-foreground: 0 0% 23%;

        --popover: 0 0% 100%;
        --popover-foreground: 0 0% 23%;

        --primary: 0 0% 35%; /* Charcoal */
        --primary-foreground: 0 0% 100%;

        --secondary: 0 0% 88%; /* Silver */
        --secondary-foreground: 0 0% 23%;

        --muted: 0 0% 92%;
        --muted-foreground: 0 0% 48%;

        --accent: 190 100% 50%; /* Cyan */
        --accent-foreground: 0 0% 23%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 0 0% 84%;
        --input: 0 0% 90%;
        --ring: 0 0% 35%;

        /* Glassmorphism - gray tinted */
        --glass-bg: rgba(100, 100, 100, 0.15);
        --glass-bg-hover: rgba(100, 100, 100, 0.22);
        --glass-bg-active: rgba(100, 100, 100, 0.3);
        --glass-surface: rgba(255, 255, 255, 0.9);
        --glass-shadow: 0 4px 16px rgba(100, 100, 100, 0.12);
    }

    :root[data-theme="monochrome"].dark {
        --background: 0 0% 8%;
        --foreground: 0 0% 88%;

        --card: 0 0% 12%;
        --card-foreground: 0 0% 88%;

        --popover: 0 0% 10%;
        --popover-foreground: 0 0% 88%;

        --primary: 0 0% 70%;
        --primary-foreground: 0 0% 8%;

        --secondary: 0 0% 22%;
        --secondary-foreground: 0 0% 88%;

        --muted: 0 0% 18%;
        --muted-foreground: 0 0% 60%;

        --accent: 190 100% 55%;
        --accent-foreground: 0 0% 8%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 0 0% 24%;
        --input: 0 0% 20%;
        --ring: 0 0% 70%;

        --glass-bg: rgba(100, 100, 100, 0.15);
        --glass-bg-hover: rgba(120, 120, 120, 0.25);
        --glass-bg-active: rgba(140, 140, 140, 0.3);
        --glass-surface: rgba(18, 18, 18, 0.95);
        --glass-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
    }
}

@layer base {
    * {
        @apply border-border;
    }

    html {
        /* Smooth scrolling for in-page navigation */
        scroll-behavior: smooth;

        /* Prevent text size adjustment on orientation change */
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;

        /* Better tap behavior on iOS */
        -webkit-tap-highlight-color: transparent;

        /* Dynamic viewport height for mobile browsers */
        height: 100dvh;
    }

    body {
        @apply bg-background text-foreground;
        font-feature-settings:
            "rlig" 1,
            "calt" 1;

        /* Prevent overscroll bounce on iOS - keeps chat contained */
        overscroll-behavior: none;
    }
}

@layer components {
    /* Glassmorphism card */
    .glass-card {
        @apply rounded-2xl p-6;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        box-shadow:
            0 8px 32px hsl(var(--primary) / 0.2),
            0 0 0 1px rgba(255, 255, 255, 0.6),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .dark .glass-card {
        background: hsl(var(--card) / 0.6);
        box-shadow:
            0 8px 32px hsl(var(--primary) / 0.3),
            0 0 0 1px rgba(255, 255, 255, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    /* User message bubble - uses theme primary color */
    .user-message-bubble {
        background: linear-gradient(
            135deg,
            hsl(var(--primary) / 0.25),
            hsl(var(--accent) / 0.2)
        );
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }

    .dark .user-message-bubble {
        background: linear-gradient(
            135deg,
            hsl(var(--primary) / 0.35),
            hsl(var(--accent) / 0.25)
        );
    }

    /* Assistant message bubble with glass effect */
    .assistant-message-bubble {
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
    }

    .dark .assistant-message-bubble {
        background: rgba(60, 50, 70, 0.6);
    }

    /* Error message bubble */
    .error-message-bubble {
        background: rgba(220, 38, 38, 0.1);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }

    .dark .error-message-bubble {
        background: rgba(180, 30, 30, 0.2);
    }

    /* Glassmorphism input dock - uses theme primary color for glow */
    .glass-input-dock {
        @apply rounded-3xl p-1.5 sm:p-2;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        box-shadow:
            0 8px 32px hsl(var(--primary) / 0.25),
            0 0 0 1px rgba(255, 255, 255, 0.7),
            inset 0 1px 0 rgba(255, 255, 255, 0.9);
    }

    .dark .glass-input-dock {
        background: hsl(var(--card) / 0.85);
        box-shadow:
            0 8px 32px rgba(0, 0, 0, 0.4),
            0 0 0 1px rgba(255, 255, 255, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    /* Call-to-action gradient button - metallic sheen effect */
    .btn-cta {
        @apply text-primary-foreground;
        background: linear-gradient(
            135deg,
            hsl(270 35% 40%) 0%,
            hsl(270 45% 60%) 30%,
            hsl(270 50% 70%) 50%,
            hsl(270 45% 55%) 70%,
            hsl(270 35% 45%) 100%
        );
        box-shadow:
            inset 0 1px 0 hsl(0 0% 100% / 0.3),
            inset 0 -1px 0 hsl(0 0% 0% / 0.2),
            0 4px 16px hsl(var(--primary) / 0.4);
    }

    .btn-cta:hover {
        box-shadow:
            inset 0 1px 0 hsl(0 0% 100% / 0.35),
            inset 0 -1px 0 hsl(0 0% 0% / 0.25),
            0 6px 24px hsl(var(--primary) / 0.5);
    }

    /* Greeting text styles */
    .greeting-title {
        @apply text-4xl font-light tracking-tight text-foreground/85 md:text-5xl;
        letter-spacing: -1.5px;
        text-shadow: 0 2px 20px rgba(255, 255, 255, 0.5);
    }

    .dark .greeting-title {
        text-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
    }

    .greeting-subtitle {
        @apply text-base text-foreground/70;
    }
}

@layer components {
    /*
     * Holographic Markdown Styles
     *
     * These styles target standard HTML elements rendered by react-markdown.
     * The .holo-markdown container scopes all markdown styling.
     */
    .holo-markdown {
        @apply text-foreground/90;
    }

    .holo-markdown > *:first-child {
        @apply mt-0;
    }

    .holo-markdown > *:last-child {
        @apply mb-0;
    }

    /* Paragraphs */
    .holo-markdown p {
        @apply mb-3;
    }

    .holo-markdown p:last-child {
        @apply mb-0;
    }

    /* Headings */
    .holo-markdown h1 {
        @apply mb-3 mt-4 text-xl font-semibold first:mt-0;
    }

    .holo-markdown h2 {
        @apply mb-2 mt-3 text-lg font-semibold first:mt-0;
    }

    .holo-markdown h3 {
        @apply mb-2 mt-3 text-base font-semibold first:mt-0;
    }

    .holo-markdown h4 {
        @apply mb-2 mt-3 text-sm font-semibold first:mt-0;
    }

    .holo-markdown h5 {
        @apply mb-1 mt-2 text-sm font-medium first:mt-0;
    }

    .holo-markdown h6 {
        @apply mb-1 mt-2 text-xs font-medium uppercase tracking-wide first:mt-0;
    }

    /* Lists */
    .holo-markdown ul {
        @apply my-2 list-disc space-y-1 pl-5;
    }

    .holo-markdown ol {
        @apply my-2 list-decimal space-y-1 pl-5;
    }

    .holo-markdown ul li,
    .holo-markdown ol li {
        @apply leading-relaxed;
    }

    /* Inline code */
    .holo-markdown code:not(pre code) {
        @apply rounded bg-foreground/10 px-1.5 py-0.5 font-mono text-sm;
    }

    /* Code blocks */
    .holo-markdown pre {
        @apply my-3 overflow-x-auto rounded-lg bg-muted p-4 font-mono text-sm text-foreground;
        backdrop-filter: blur(8px);
    }

    .holo-markdown pre code {
        @apply bg-transparent p-0;
    }

    /* Blockquotes */
    .holo-markdown blockquote {
        @apply my-3 border-l-2 border-foreground/20 pl-4 italic text-foreground/70;
    }

    /* Links */
    .holo-markdown a {
        @apply text-primary underline decoration-primary/30 transition-colors hover:decoration-primary;
    }

    /* Horizontal rule */
    .holo-markdown hr {
        @apply my-4 border-foreground/10;
    }

    /* Tables - Enhanced with rounded borders and hover effects */
    .holo-markdown table {
        @apply w-full text-sm;
    }

    .holo-markdown thead {
        @apply bg-foreground/[0.12];
    }

    .holo-markdown th {
        @apply border-b border-foreground/15 px-3 py-2 text-left font-semibold;
    }

    .holo-markdown th:first-child {
        @apply rounded-tl-lg;
    }

    .holo-markdown th:last-child {
        @apply rounded-tr-lg;
    }

    .holo-markdown tbody tr {
        @apply transition-colors hover:bg-foreground/[0.02];
    }

    .holo-markdown td {
        @apply border-b border-foreground/10 px-3 py-2;
    }

    .holo-markdown tbody tr:last-child td {
        @apply border-b-0;
    }

    .holo-markdown tbody tr:last-child td:first-child {
        @apply rounded-bl-lg;
    }

    .holo-markdown tbody tr:last-child td:last-child {
        @apply rounded-br-lg;
    }
}

@layer utilities {
    /* Custom scrollbar - supports both vertical and horizontal scrolling */
    .scrollbar-holo {
        scrollbar-width: thin;
        scrollbar-color: rgba(139, 102, 184, 0.3) transparent;
    }

    .dark .scrollbar-holo {
        scrollbar-color: rgba(139, 102, 184, 0.3) transparent;
    }

    .scrollbar-holo::-webkit-scrollbar {
        width: 8px;
        height: 8px; /* Enable horizontal scrollbar */
    }

    .scrollbar-holo::-webkit-scrollbar-track {
        background: transparent;
    }

    .scrollbar-holo::-webkit-scrollbar-thumb {
        background: rgba(139, 102, 184, 0.3);
        border-radius: 4px;
    }

    .dark .scrollbar-holo::-webkit-scrollbar-thumb {
        background: rgba(139, 102, 184, 0.3);
    }

    .scrollbar-holo::-webkit-scrollbar-thumb:hover {
        background: rgba(139, 102, 184, 0.5);
    }

    .dark .scrollbar-holo::-webkit-scrollbar-thumb:hover {
        background: rgba(139, 102, 184, 0.5);
    }

    .scrollbar-holo::-webkit-scrollbar-corner {
        background: transparent; /* Clean corner where scrollbars meet */
    }

    /*
     * Chat viewport fade - Apple-level subtle bidirectional fades
     *
     * Creates whisper-thin fades at both edges:
     * - Top fade (40px): subtle hint under the header
     * - Bottom fade (56px): gentle transition into input dock area
     *
     * The fades are fixed pixels, not percentages, ensuring they remain
     * subtle regardless of viewport height. Content stays readable until
     * the very edge - these are polish, not visibility blockers.
     */
    .chat-viewport-fade {
        mask-image: linear-gradient(
            to bottom,
            transparent,
            black var(--chat-fade-top),
            black calc(100% - var(--chat-fade-bottom)),
            transparent
        );
        -webkit-mask-image: linear-gradient(
            to bottom,
            transparent,
            black var(--chat-fade-top),
            black calc(100% - var(--chat-fade-bottom)),
            transparent
        );
    }

    /*
     * Expandable Text Component Styles
     *
     * Used for collapsing long user messages with a blur fade indicator.
     * See knowledge/components/text-expansion.md for design decisions.
     */

    /* Blur gradient fade for truncated content - matches chat viewport fade */
    .expandable-text-fade {
        mask-image: linear-gradient(
            to bottom,
            black 0%,
            black calc(100% - var(--chat-fade-bottom)),
            transparent 100%
        );
        -webkit-mask-image: linear-gradient(
            to bottom,
            black 0%,
            black calc(100% - var(--chat-fade-bottom)),
            transparent 100%
        );
    }

    /* Dashed frame for expandable text (optional, per spec) */
    .expandable-text-frame {
        @apply rounded-lg border-2 border-dashed p-4;
        border-color: hsl(280 40% 75% / 0.4); /* purple-300 at 40% opacity */
    }

    /* Gentle rotating animation for loading spinner */
    @keyframes spin-slow {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    .animate-spin-slow {
        animation: spin-slow 2s linear infinite;
    }

    /* Subtle shimmer for loading states - GPU accelerated */
    @keyframes shimmer {
        0% {
            background-position: -200% 0;
        }
        100% {
            background-position: 200% 0;
        }
    }

    .animate-shimmer {
        background: linear-gradient(
            90deg,
            hsl(var(--muted) / 0.3) 0%,
            hsl(var(--muted) / 0.5) 50%,
            hsl(var(--muted) / 0.3) 100%
        );
        background-size: 200% 100%;
        animation: shimmer 2s ease-in-out infinite;
    }

    /*
     * Oracle Animations
     *
     * Visual states for the Carmenta Oracle icon.
     * These communicate Carmenta's current activity level.
     */

    /* ========== BREATHING ANIMATIONS (10 variations: 5 glow + 5 container) ========== */

    /* ===== GLOW VARIATIONS (1-5) ===== */

    /* Glow 1: Whisper - very subtle, slow */
    @keyframes oracle-breathe-glow-1 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.25;
        }
        50% {
            transform: scale(1.5);
            opacity: 0.55;
        }
    }

    /* Glow 2: Gentle - balanced, soft */
    @keyframes oracle-breathe-glow-2 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.3;
        }
        50% {
            transform: scale(1.8);
            opacity: 0.7;
        }
    }

    /* Glow 3: Warm - more pronounced */
    @keyframes oracle-breathe-glow-3 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.35;
        }
        50% {
            transform: scale(2);
            opacity: 0.85;
        }
    }

    /* Glow 4: Vivid - stronger presence */
    @keyframes oracle-breathe-glow-4 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.4;
        }
        50% {
            transform: scale(2.2);
            opacity: 0.95;
        }
    }

    /* Glow 5: Deep - slow, dramatic */
    @keyframes oracle-breathe-glow-5 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.2;
        }
        50% {
            transform: scale(2.5);
            opacity: 0.9;
        }
    }

    /* ===== BREATHING: Container "Slow" - centered ±10%, 8s ===== */
    /* Scales from 0.90 (exhale) → 1.10 (inhale) → 0.90 */
    @keyframes oracle-breathe {
        0%,
        100% {
            transform: scale(0.9);
        }
        50% {
            transform: scale(1.1);
        }
    }

    .oracle-breathing {
        animation: oracle-breathe 8s ease-in-out infinite;
    }

    /* On hover: stop breathing, reset to base scale, let btn-hoverable handle the rest */
    .oracle-breathing:hover {
        animation: none;
    }

    /* ===== WORKING: Rainbow + Glow "Slow" - 3s ===== */
    @keyframes oracle-rainbow-spin {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    @keyframes oracle-rainbow-glow {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.4;
        }
        50% {
            transform: scale(1.8);
            opacity: 0.9;
        }
    }

    .oracle-working-glow {
        animation: oracle-rainbow-glow 3s ease-in-out infinite;
    }

    .oracle-working-ring {
        animation: oracle-rainbow-spin 3s linear infinite;
    }

    /* ========== NOTIFICATION ANIMATIONS (5 distinct styles) ========== */

    /* N1: Expanding rings - concentric circles pulse outward */
    @keyframes oracle-ring-expand {
        0% {
            transform: scale(1);
            opacity: 1;
        }
        100% {
            transform: scale(2.5);
            opacity: 0;
        }
    }

    /* N2: Pop bounce - icon pops up and bounces */
    @keyframes oracle-pop {
        0% {
            transform: scale(1);
        }
        30% {
            transform: scale(1.3);
        }
        50% {
            transform: scale(0.95);
        }
        70% {
            transform: scale(1.1);
        }
        100% {
            transform: scale(1);
        }
    }

    /* N3: Sparkle burst - particles explode outward */
    @keyframes oracle-sparkle-out {
        0% {
            transform: translateX(0) scale(1);
            opacity: 1;
        }
        100% {
            transform: translateX(var(--sparkle-distance)) scale(0);
            opacity: 0;
        }
    }

    /* N4: Glow flash - bright flash then settle */
    @keyframes oracle-flash {
        0% {
            opacity: 0;
            transform: scale(0.8);
        }
        20% {
            opacity: 1;
            transform: scale(2);
        }
        100% {
            opacity: 0.3;
            transform: scale(1.5);
        }
    }

    /* N5: Shake/wiggle - attention grabbing shake */
    @keyframes oracle-shake {
        0%,
        100% {
            transform: rotate(0deg);
        }
        10% {
            transform: rotate(-8deg);
        }
        20% {
            transform: rotate(8deg);
        }
        30% {
            transform: rotate(-6deg);
        }
        40% {
            transform: rotate(6deg);
        }
        50% {
            transform: rotate(-4deg);
        }
        60% {
            transform: rotate(4deg);
        }
        70% {
            transform: rotate(-2deg);
        }
        80% {
            transform: rotate(2deg);
        }
        90% {
            transform: rotate(0deg);
        }
    }

    /* Shared notify glow */
    @keyframes oracle-notify-glow {
        0% {
            transform: scale(1);
            opacity: 0.3;
        }
        30% {
            transform: scale(1.6);
            opacity: 1;
        }
        100% {
            transform: scale(1.2);
            opacity: 0.5;
        }
    }

    /* Ripple effect for button clicks */
    @keyframes ripple {
        0% {
            transform: translate(-50%, -50%) scale(0);
            opacity: 0.6;
        }
        100% {
            transform: translate(-50%, -50%) scale(10);
            opacity: 0;
        }
    }

    .animate-ripple {
        animation: ripple 0.6s ease-out;
    }

    /* Shake animation for errors */
    @keyframes shake {
        0%,
        100% {
            transform: translateX(0);
        }
        25% {
            transform: translateX(-8px);
        }
        75% {
            transform: translateX(8px);
        }
    }

    /* Carmenta Glass System - DRY glassmorphism using CSS variables */

    /* Glass background utilities - auto-switch between light/dark */
    .glass-bg {
        background: var(--glass-bg);
    }

    .glass-bg-hover:hover {
        background: var(--glass-bg-hover);
    }

    .glass-bg-active {
        background: var(--glass-bg-active);
    }

    .glass-surface {
        background: var(--glass-surface);
    }

    .glass-shadow {
        box-shadow: var(--glass-shadow);
    }

    /* Glass container - for popovers, dropdowns, panels */
    .glass-container {
        background: var(--glass-surface);
        box-shadow: var(--glass-shadow);
        @apply ring-1 ring-white/40 backdrop-blur-xl;
    }

    .dark .glass-container {
        @apply ring-white/15;
    }

    /* Glass pill - for buttons in glass containers (e.g., connection chooser) */
    .glass-pill {
        background: var(--glass-bg);
        box-shadow: var(--glass-shadow);
        @apply rounded-xl ring-1 ring-foreground/15 backdrop-blur-xl;
        @apply transition-all duration-200;
    }

    .glass-pill:hover {
        background: var(--glass-bg-hover);
        @apply shadow-2xl ring-foreground/20;
    }

    .dark .glass-pill {
        @apply ring-white/15;
    }

    /* Carmenta Button States - Centralized interaction patterns */

    /* Glass button base - uses CSS variables */
    .btn-glass {
        @apply flex items-center justify-center rounded-full;
        background: var(--glass-bg);
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.08);
        @apply ring-1 ring-foreground/10 backdrop-blur-xl;
        @apply transition-all duration-300;
    }

    .dark .btn-glass {
        @apply ring-white/15;
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.25);
    }

    /* Click state - Ripple + depth shift */
    .btn-clickable {
        @apply active:translate-y-0.5 active:shadow-sm;
    }

    /* Hover state - Scale + shadow + ring (same as focus) */
    .btn-hoverable {
        @apply hover:scale-105 hover:shadow-2xl hover:ring-[3px] hover:ring-primary/40;
    }

    .btn-hoverable:hover {
        background: var(--glass-bg-hover);
    }

    /* Focus state - Scale + shadow + ring (same as hover) */
    .btn-focusable {
        @apply focus:scale-105 focus:shadow-2xl focus:outline-none focus:ring-[3px] focus:ring-primary/40;
    }

    /* Disabled state - Grayscale */
    .btn-disabled {
        @apply cursor-not-allowed opacity-50 grayscale;
    }

    /* Complete glass button with all states */
    .btn-glass-interactive {
        @apply btn-glass btn-clickable btn-hoverable btn-focusable;
    }

    /* Icon button variant */
    .btn-icon-glass {
        @apply btn-glass-interactive h-10 w-10 sm:h-12 sm:w-12;
    }

    /* Subtle buttons - for buttons inside glass containers */
    /* These don't need full glass treatment since they're already in a glass container */

    /* Base subtle button - hover and focus are identical */
    .btn-subtle {
        @apply rounded-md transition-all;
        @apply hover:ring-2 hover:ring-primary/30;
        @apply focus:outline-none focus:ring-2 focus:ring-primary/30;
        @apply active:scale-95;
    }

    .btn-subtle:hover,
    .btn-subtle:focus {
        background: var(--glass-bg-hover);
    }

    /* Subtle icon button - small icons with scale effect */
    .btn-subtle-icon {
        @apply btn-subtle p-1;
        @apply hover:scale-110 focus:scale-110;
    }

    /* Subtle text button - for text/label buttons */
    .btn-subtle-text {
        @apply btn-subtle px-2 py-1;
        @apply hover:scale-105 focus:scale-105;
    }
}
