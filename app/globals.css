@import "tailwindcss";
@import "tw-animate-css";
@config "../tailwind.config.ts";

/*
 * Holographic Dream Theme
 *
 * Design tokens and utility classes for Carmenta's visual language.
 * No !important hacks - we use headless primitives instead of fighting
 * pre-styled components.
 */

@layer base {
    :root {
        /* Background & Surface */
        --background: 320 20% 97%; /* #F8F4F8 */
        --foreground: 285 25% 31%;

        --card: 0 0% 100%;
        --card-foreground: 285 25% 31%;

        --popover: 0 0% 100%;
        --popover-foreground: 285 25% 31%;

        /* Primary - Royal Purple */
        --primary: 270 40% 56%;
        --primary-foreground: 0 0% 100%;

        /* Secondary */
        --secondary: 280 20% 95%;
        --secondary-foreground: 285 25% 31%;

        /* Muted */
        --muted: 280 20% 92%;
        --muted-foreground: 285 20% 50%;

        /* Accent */
        --accent: 280 30% 88%;
        --accent-foreground: 285 25% 31%;

        /* Destructive */
        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        /* Borders & Inputs */
        --border: 280 20% 85%;
        --input: 280 20% 90%;
        --ring: 270 40% 56%;

        /* Border radius */
        --radius: 0.75rem;

        /* Glassmorphism - purple tinted for holo theme */
        --glass-blur: 24px;
        --glass-bg: rgba(196, 163, 212, 0.25);
        --glass-bg-hover: rgba(196, 163, 212, 0.35);
        --glass-bg-active: rgba(196, 163, 212, 0.45);
        --glass-surface: rgba(255, 255, 255, 0.9);
        --glass-shadow: 0 4px 16px rgba(139, 102, 184, 0.15);

        /* Chat viewport fade - soft mask at top edge only
         * Top fade creates gentle transition from header glass
         * Bottom has NO fade - users read newest content there */
        --chat-fade-top: 32px;
        --chat-fade-bottom: 0px;

        /* Z-Index Scale (mirrors tailwind.config.ts)
         * Use Tailwind classes (z-content, z-modal, etc.) in components.
         * These CSS vars are for non-Tailwind CSS like the tooltip. */
        --z-base: 0;
        --z-content: 10;
        --z-sticky: 20;
        --z-dropdown: 30;
        --z-backdrop: 40;
        --z-modal: 50;
        --z-tooltip: 50;
        --z-toast: 60;
        --z-loading: 70;
    }

    /* Dark mode - Cosmic consciousness depths with ethereal shimmer */
    .dark {
        /* Deep cosmic indigo-violet - richness with subtle purple glow */
        --background: 265 45% 6%;
        --foreground: 280 25% 92%;

        /* Cards lift from the depths with subtle luminescence */
        --card: 268 40% 11%;
        --card-foreground: 280 25% 92%;

        /* Popovers emerge from shadow with gentle radiance */
        --popover: 266 42% 9%;
        --popover-foreground: 280 25% 92%;

        /* Primary - Luminous amethyst with goddess energy */
        --primary: 275 60% 68%;
        --primary-foreground: 265 45% 6%;

        /* Secondary - Twilight depths */
        --secondary: 270 30% 18%;
        --secondary-foreground: 280 25% 92%;

        /* Muted - Soft shadow with violet undertones */
        --muted: 268 25% 16%;
        --muted-foreground: 275 18% 65%;

        /* Accent - Deep mystery with purple whispers */
        --accent: 272 35% 22%;
        --accent-foreground: 280 25% 92%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        /* Borders shimmer at the edge of perception */
        --border: 270 25% 24%;
        --input: 268 28% 19%;
        --ring: 275 60% 68%;

        /* Ethereal glassmorphism - consciousness made visible */
        --glass-bg: rgba(139, 102, 184, 0.18);
        --glass-bg-hover: rgba(155, 120, 200, 0.28);
        --glass-bg-active: rgba(165, 130, 210, 0.35);
        --glass-surface: rgba(28, 20, 42, 0.96);
        --glass-shadow: 0 4px 24px rgba(120, 80, 160, 0.25);
    }

    /* ===== WARM EARTH THEME ===== */
    /* Terracotta, sage, and gold - warm and grounded */
    :root[data-theme="warm-earth"] {
        --background: 30 25% 95%;
        --foreground: 25 35% 25%;

        --card: 0 0% 100%;
        --card-foreground: 25 35% 25%;

        --popover: 0 0% 100%;
        --popover-foreground: 25 35% 25%;

        --primary: 15 60% 60%; /* Terracotta */
        --primary-foreground: 0 0% 100%;

        --secondary: 80 30% 85%; /* Sage */
        --secondary-foreground: 25 35% 25%;

        --muted: 30 20% 90%;
        --muted-foreground: 25 25% 45%;

        --accent: 40 50% 65%; /* Gold */
        --accent-foreground: 25 35% 25%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 30 20% 82%;
        --input: 30 20% 88%;
        --ring: 15 60% 60%;

        /* Glassmorphism - terracotta tinted */
        --glass-bg: rgba(200, 120, 80, 0.2);
        --glass-bg-hover: rgba(200, 120, 80, 0.3);
        --glass-bg-active: rgba(200, 120, 80, 0.4);
        --glass-surface: rgba(255, 250, 240, 0.9);
        --glass-shadow: 0 4px 16px rgba(200, 120, 80, 0.15);
    }

    :root[data-theme="warm-earth"].dark {
        /* Ember glow depths - warm clay and smoldering terracotta */
        --background: 20 38% 8%;
        --foreground: 30 22% 90%;

        /* Cards emerge like pottery from the kiln */
        --card: 22 35% 13%;
        --card-foreground: 30 22% 90%;

        --popover: 21 36% 10%;
        --popover-foreground: 30 22% 90%;

        /* Primary - Living ember warmth */
        --primary: 15 70% 62%;
        --primary-foreground: 20 38% 8%;

        /* Secondary - Ancient clay */
        --secondary: 80 25% 22%;
        --secondary-foreground: 30 22% 90%;

        --muted: 22 28% 17%;
        --muted-foreground: 30 20% 62%;

        /* Accent - Honey amber glow */
        --accent: 40 60% 58%;
        --accent-foreground: 20 38% 8%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 24 24% 26%;
        --input: 22 26% 19%;
        --ring: 15 70% 62%;

        /* Warm ember glassmorphism */
        --glass-bg: rgba(200, 120, 80, 0.18);
        --glass-bg-hover: rgba(220, 135, 90, 0.28);
        --glass-bg-active: rgba(230, 145, 95, 0.35);
        --glass-surface: rgba(38, 26, 20, 0.96);
        --glass-shadow: 0 4px 24px rgba(180, 100, 60, 0.25);
    }

    /* ===== ARCTIC CLARITY THEME ===== */
    /* Ice blue precision - cool and clear */
    :root[data-theme="arctic-clarity"] {
        --background: 200 30% 96%;
        --foreground: 210 30% 25%;

        --card: 0 0% 100%;
        --card-foreground: 210 30% 25%;

        --popover: 0 0% 100%;
        --popover-foreground: 210 30% 25%;

        --primary: 200 70% 55%; /* Ice blue */
        --primary-foreground: 0 0% 100%;

        --secondary: 200 25% 90%;
        --secondary-foreground: 210 30% 25%;

        --muted: 200 20% 92%;
        --muted-foreground: 210 20% 48%;

        --accent: 190 60% 65%; /* Aqua */
        --accent-foreground: 210 30% 25%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 200 20% 84%;
        --input: 200 20% 90%;
        --ring: 200 70% 55%;

        /* Glassmorphism - ice blue tinted */
        --glass-bg: rgba(100, 180, 220, 0.2);
        --glass-bg-hover: rgba(100, 180, 220, 0.3);
        --glass-bg-active: rgba(100, 180, 220, 0.4);
        --glass-surface: rgba(240, 250, 255, 0.9);
        --glass-shadow: 0 4px 16px rgba(100, 180, 220, 0.15);
    }

    :root[data-theme="arctic-clarity"].dark {
        /* Frozen aurora depths - deep ice blue with northern lights */
        --background: 215 50% 7%;
        --foreground: 200 28% 90%;

        /* Cards crystallize from the frost */
        --card: 213 45% 12%;
        --card-foreground: 200 28% 90%;

        --popover: 214 48% 9%;
        --popover-foreground: 200 28% 90%;

        /* Primary - Electric ice luminescence */
        --primary: 200 80% 65%;
        --primary-foreground: 215 50% 7%;

        /* Secondary - Deep glacier */
        --secondary: 210 32% 20%;
        --secondary-foreground: 200 28% 90%;

        --muted: 212 28% 17%;
        --muted-foreground: 200 24% 64%;

        /* Accent - Aurora aquamarine */
        --accent: 190 70% 62%;
        --accent-foreground: 215 50% 7%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 210 26% 26%;
        --input: 212 30% 19%;
        --ring: 200 80% 65%;

        /* Frozen aurora glassmorphism */
        --glass-bg: rgba(100, 180, 220, 0.18);
        --glass-bg-hover: rgba(115, 195, 235, 0.28);
        --glass-bg-active: rgba(125, 205, 245, 0.35);
        --glass-surface: rgba(16, 26, 38, 0.96);
        --glass-shadow: 0 4px 24px rgba(80, 150, 200, 0.25);
    }

    /* ===== FOREST WISDOM THEME ===== */
    /* Natural green and amber - organic and grounded */
    :root[data-theme="forest-wisdom"] {
        --background: 80 20% 95%;
        --foreground: 140 30% 22%;

        --card: 0 0% 100%;
        --card-foreground: 140 30% 22%;

        --popover: 0 0% 100%;
        --popover-foreground: 140 30% 22%;

        --primary: 140 45% 45%; /* Forest green */
        --primary-foreground: 0 0% 100%;

        --secondary: 80 25% 88%;
        --secondary-foreground: 140 30% 22%;

        --muted: 80 20% 90%;
        --muted-foreground: 140 20% 42%;

        --accent: 35 60% 60%; /* Amber */
        --accent-foreground: 140 30% 22%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 80 20% 82%;
        --input: 80 20% 88%;
        --ring: 140 45% 45%;

        /* Glassmorphism - forest green tinted */
        --glass-bg: rgba(100, 160, 120, 0.2);
        --glass-bg-hover: rgba(100, 160, 120, 0.3);
        --glass-bg-active: rgba(100, 160, 120, 0.4);
        --glass-surface: rgba(245, 250, 240, 0.9);
        --glass-shadow: 0 4px 16px rgba(100, 160, 120, 0.15);
    }

    :root[data-theme="forest-wisdom"].dark {
        /* Midnight forest depths - ancient moss and moonlit canopy */
        --background: 145 35% 8%;
        --foreground: 80 25% 90%;

        /* Cards grow from the forest floor */
        --card: 143 32% 13%;
        --card-foreground: 80 25% 90%;

        --popover: 144 34% 10%;
        --popover-foreground: 80 25% 90%;

        /* Primary - Living moss luminescence */
        --primary: 140 55% 52%;
        --primary-foreground: 145 35% 8%;

        /* Secondary - Deep woodland */
        --secondary: 140 25% 22%;
        --secondary-foreground: 80 25% 90%;

        --muted: 142 26% 17%;
        --muted-foreground: 80 22% 62%;

        /* Accent - Firefly amber */
        --accent: 35 70% 60%;
        --accent-foreground: 145 35% 8%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 140 24% 26%;
        --input: 142 26% 19%;
        --ring: 140 55% 52%;

        /* Forest essence glassmorphism */
        --glass-bg: rgba(100, 160, 120, 0.18);
        --glass-bg-hover: rgba(115, 175, 130, 0.28);
        --glass-bg-active: rgba(125, 185, 140, 0.35);
        --glass-surface: rgba(22, 32, 26, 0.96);
        --glass-shadow: 0 4px 24px rgba(80, 140, 100, 0.25);
    }

    /* ===== MONOCHROME THEME ===== */
    /* Charcoal, silver, and cyan accent - minimal and precise */
    :root[data-theme="monochrome"] {
        --background: 0 0% 98%;
        --foreground: 0 0% 23%;

        --card: 0 0% 100%;
        --card-foreground: 0 0% 23%;

        --popover: 0 0% 100%;
        --popover-foreground: 0 0% 23%;

        --primary: 0 0% 35%; /* Charcoal */
        --primary-foreground: 0 0% 100%;

        --secondary: 0 0% 88%; /* Silver */
        --secondary-foreground: 0 0% 23%;

        --muted: 0 0% 92%;
        --muted-foreground: 0 0% 48%;

        --accent: 190 100% 50%; /* Cyan */
        --accent-foreground: 0 0% 23%;

        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        --border: 0 0% 84%;
        --input: 0 0% 90%;
        --ring: 0 0% 35%;

        /* Glassmorphism - gray tinted */
        --glass-bg: rgba(100, 100, 100, 0.15);
        --glass-bg-hover: rgba(100, 100, 100, 0.22);
        --glass-bg-active: rgba(100, 100, 100, 0.3);
        --glass-surface: rgba(255, 255, 255, 0.9);
        --glass-shadow: 0 4px 16px rgba(100, 100, 100, 0.12);
    }

    :root[data-theme="monochrome"].dark {
        /* Deep graphite void - pure precision with subtle cyan breath */
        --background: 210 8% 6%;
        --foreground: 210 5% 92%;

        /* Cards emerge from shadow layers */
        --card: 210 7% 11%;
        --card-foreground: 210 5% 92%;

        --popover: 210 8% 8%;
        --popover-foreground: 210 5% 92%;

        /* Primary - Platinum luminance */
        --primary: 210 6% 75%;
        --primary-foreground: 210 8% 6%;

        /* Secondary - Charcoal depth */
        --secondary: 210 6% 20%;
        --secondary-foreground: 210 5% 92%;

        --muted: 210 6% 16%;
        --muted-foreground: 210 4% 64%;

        /* Accent - Electric cyan spark */
        --accent: 190 100% 58%;
        --accent-foreground: 210 8% 6%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 210 5% 26%;
        --input: 210 6% 18%;
        --ring: 210 6% 75%;

        /* Precision glassmorphism with subtle cool undertone */
        --glass-bg: rgba(110, 115, 125, 0.16);
        --glass-bg-hover: rgba(125, 130, 140, 0.26);
        --glass-bg-active: rgba(140, 145, 155, 0.32);
        --glass-surface: rgba(16, 18, 20, 0.97);
        --glass-shadow: 0 4px 24px rgba(0, 0, 0, 0.5);
    }

    /* ===== CHRISTMAS THEME ===== */
    /* Classic Christmas - rich reds, forest greens, warm golds */
    :root[data-theme="christmas"] {
        --background: 140 25% 96%; /* Hint of evergreen frost */
        --foreground: 150 35% 18%; /* Deep forest green text */

        --card: 0 0% 100%;
        --card-foreground: 150 35% 18%;

        --popover: 0 0% 100%;
        --popover-foreground: 150 35% 18%;

        --primary: 350 72% 42%; /* Rich Christmas red */
        --primary-foreground: 0 0% 100%;

        --secondary: 145 45% 38%; /* Visible evergreen */
        --secondary-foreground: 0 0% 100%;

        --muted: 145 15% 90%;
        --muted-foreground: 150 20% 35%;

        --accent: 42 90% 48%; /* Bright gold star */
        --accent-foreground: 150 35% 15%;

        --destructive: 0 60% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 145 18% 82%;
        --input: 145 15% 90%;
        --ring: 350 72% 42%;

        /* Glassmorphism - red and green holiday tinted */
        --glass-bg: rgba(60, 120, 80, 0.1);
        --glass-bg-hover: rgba(140, 60, 60, 0.15);
        --glass-bg-active: rgba(140, 60, 60, 0.22);
        --glass-surface: rgba(250, 255, 252, 0.94);
        --glass-shadow: 0 4px 16px rgba(40, 90, 60, 0.12);
    }

    :root[data-theme="christmas"].dark {
        /* Christmas night - Sage Evening green with warm snow */
        --background: 152 28% 21%; /* Sage Evening - airy forest */
        --foreground: 45 20% 95%; /* Warm snow white */

        /* Cards like wrapped presents - subtle contrast */
        --card: 152 28% 17%;
        --card-foreground: 45 20% 95%;

        --popover: 152 28% 15%;
        --popover-foreground: 45 20% 95%;

        /* Primary - Luminous Christmas red */
        --primary: 350 72% 50%;
        --primary-foreground: 0 0% 100%;

        /* Secondary - Glowing evergreen */
        --secondary: 145 45% 32%;
        --secondary-foreground: 45 20% 95%;

        --muted: 152 25% 26%;
        --muted-foreground: 145 15% 65%;

        /* Accent - Golden ornament glow */
        --accent: 42 85% 55%;
        --accent-foreground: 152 28% 15%;

        --destructive: 0 55% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 152 22% 28%;
        --input: 152 25% 26%;
        --ring: 350 72% 50%;

        /* Sage Evening glassmorphism - all green tones */
        --glass-bg: rgba(55, 100, 75, 0.22);
        --glass-bg-hover: rgba(65, 115, 85, 0.28);
        --glass-bg-active: rgba(75, 130, 95, 0.35);
        --glass-surface: rgba(28, 52, 38, 0.96);
        --glass-shadow: 0 4px 24px rgba(35, 66, 48, 0.4);
    }
}

@layer base {
    * {
        @apply border-border;
    }

    html {
        /* Smooth scrolling for in-page navigation */
        scroll-behavior: smooth;

        /* Prevent text size adjustment on orientation change */
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;

        /* Better tap behavior on iOS */
        -webkit-tap-highlight-color: transparent;

        /* Dynamic viewport height for mobile browsers */
        height: 100dvh;
    }

    body {
        @apply bg-background text-foreground;
        font-feature-settings:
            "rlig" 1,
            "calt" 1;

        /* Prevent overscroll bounce on iOS - keeps chat contained */
        overscroll-behavior: none;
    }
}

@layer components {
    /* Content page container - standardized width and padding for informational pages */
    .content-page {
        @apply mx-auto w-full px-6 sm:px-8 lg:px-10;
        max-width: 56rem; /* 896px - 4xl equivalent */
    }

    /* Glassmorphism card */
    .glass-card {
        @apply rounded-2xl p-6;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        box-shadow:
            0 8px 32px hsl(var(--primary) / 0.2),
            0 0 0 1px rgba(255, 255, 255, 0.6),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .dark .glass-card {
        background: hsl(var(--card) / 0.6);
        box-shadow:
            0 8px 32px hsl(var(--primary) / 0.3),
            0 0 0 1px rgba(255, 255, 255, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    /* User message bubble - uses theme primary color */
    .user-message-bubble {
        background: linear-gradient(
            135deg,
            hsl(var(--primary) / 0.25),
            hsl(var(--accent) / 0.2)
        );
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }

    .dark .user-message-bubble {
        background: linear-gradient(
            135deg,
            hsl(var(--primary) / 0.35),
            hsl(var(--accent) / 0.25)
        );
    }

    /* Assistant message bubble with glass effect */
    .assistant-message-bubble {
        background: rgba(255, 255, 255, 0.75);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
    }

    .dark .assistant-message-bubble {
        background: rgba(60, 50, 70, 0.75);
    }

    /* Error message bubble */
    .error-message-bubble {
        background: rgba(220, 38, 38, 0.1);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }

    .dark .error-message-bubble {
        background: rgba(180, 30, 30, 0.2);
    }

    /* Glassmorphism input dock */
    .glass-input-dock {
        @apply rounded-3xl p-1 sm:p-2;
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(32px);
        -webkit-backdrop-filter: blur(32px);
    }

    .dark .glass-input-dock {
        background: hsl(var(--card) / 0.7);
    }

    /* Call-to-action gradient button - metallic sheen effect */
    .btn-cta {
        @apply text-primary-foreground;
        background: linear-gradient(
            135deg,
            hsl(270 35% 40%) 0%,
            hsl(270 45% 60%) 30%,
            hsl(270 50% 70%) 50%,
            hsl(270 45% 55%) 70%,
            hsl(270 35% 45%) 100%
        );
        box-shadow:
            inset 0 1px 0 hsl(0 0% 100% / 0.3),
            inset 0 -1px 0 hsl(0 0% 0% / 0.2),
            0 4px 16px hsl(var(--primary) / 0.4);
    }

    .btn-cta:hover {
        box-shadow:
            inset 0 1px 0 hsl(0 0% 100% / 0.35),
            inset 0 -1px 0 hsl(0 0% 0% / 0.25),
            0 6px 24px hsl(var(--primary) / 0.5);
    }

    /* =============================================
     * Greeting Styles - Theme-Adaptive Gradient Text
     * =============================================
     * Uses CSS custom properties for gradient colors so each theme
     * can define its own gradient stops. Text shadow improves
     * legibility against gradient backgrounds.
     */

    /* Gradient color tokens - default carmenta theme */
    :root {
        --greeting-gradient-start: hsl(260 70% 55%); /* Rich purple */
        --greeting-gradient-mid: hsl(280 65% 60%); /* Vivid violet */
        --greeting-gradient-end: hsl(310 60% 55%); /* Bright magenta */
        --greeting-subtitle-color: hsl(285 20% 50%);
    }

    .dark {
        --greeting-gradient-start: hsl(265 75% 70%); /* Luminous purple */
        --greeting-gradient-mid: hsl(285 70% 75%); /* Bright violet */
        --greeting-gradient-end: hsl(315 65% 72%); /* Vibrant magenta */
        --greeting-subtitle-color: hsl(280 20% 72%);
    }

    /* Warm Earth theme gradient */
    :root[data-theme="warm-earth"] {
        --greeting-gradient-start: hsl(15 55% 45%);
        --greeting-gradient-mid: hsl(25 60% 55%);
        --greeting-gradient-end: hsl(40 55% 50%);
        --greeting-subtitle-color: hsl(25 25% 40%);
    }

    :root[data-theme="warm-earth"].dark {
        --greeting-gradient-start: hsl(15 70% 65%);
        --greeting-gradient-mid: hsl(25 65% 70%);
        --greeting-gradient-end: hsl(40 60% 65%);
        --greeting-subtitle-color: hsl(30 20% 68%);
    }

    /* Arctic Clarity theme gradient */
    :root[data-theme="arctic-clarity"] {
        --greeting-gradient-start: hsl(200 55% 40%);
        --greeting-gradient-mid: hsl(185 50% 45%);
        --greeting-gradient-end: hsl(210 55% 50%);
        --greeting-subtitle-color: hsl(200 25% 42%);
    }

    :root[data-theme="arctic-clarity"].dark {
        --greeting-gradient-start: hsl(195 60% 65%);
        --greeting-gradient-mid: hsl(180 55% 68%);
        --greeting-gradient-end: hsl(205 60% 70%);
        --greeting-subtitle-color: hsl(195 20% 68%);
    }

    /* Forest Wisdom theme gradient */
    :root[data-theme="forest-wisdom"] {
        --greeting-gradient-start: hsl(140 40% 35%);
        --greeting-gradient-mid: hsl(120 35% 42%);
        --greeting-gradient-end: hsl(80 45% 45%);
        --greeting-subtitle-color: hsl(130 20% 38%);
    }

    :root[data-theme="forest-wisdom"].dark {
        --greeting-gradient-start: hsl(140 45% 58%);
        --greeting-gradient-mid: hsl(125 40% 62%);
        --greeting-gradient-end: hsl(85 50% 60%);
        --greeting-subtitle-color: hsl(130 18% 65%);
    }

    /* Monochrome theme gradient */
    :root[data-theme="monochrome"] {
        --greeting-gradient-start: hsl(220 10% 35%);
        --greeting-gradient-mid: hsl(220 12% 45%);
        --greeting-gradient-end: hsl(220 8% 50%);
        --greeting-subtitle-color: hsl(220 8% 42%);
    }

    :root[data-theme="monochrome"].dark {
        --greeting-gradient-start: hsl(220 8% 72%);
        --greeting-gradient-mid: hsl(220 10% 78%);
        --greeting-gradient-end: hsl(220 6% 82%);
        --greeting-subtitle-color: hsl(220 6% 68%);
    }

    /* Christmas theme gradient - red to green festive */
    :root[data-theme="christmas"] {
        --greeting-gradient-start: hsl(350 72% 42%); /* Christmas red */
        --greeting-gradient-mid: hsl(42 90% 45%); /* Gold star */
        --greeting-gradient-end: hsl(145 45% 38%); /* Evergreen */
        --greeting-subtitle-color: hsl(150 25% 35%);
    }

    :root[data-theme="christmas"].dark {
        --greeting-gradient-start: hsl(350 75% 58%); /* Bright red */
        --greeting-gradient-mid: hsl(42 85% 58%); /* Golden glow */
        --greeting-gradient-end: hsl(145 50% 45%); /* Glowing green */
        --greeting-subtitle-color: hsl(145 20% 60%);
    }

    .greeting-container {
        @apply text-center;
    }

    /* Legacy class for backwards compatibility */
    .greeting-gradient {
        @apply text-[44px] leading-tight font-semibold tracking-tight md:text-5xl;
        letter-spacing: -1.5px;
        background: linear-gradient(
            135deg,
            var(--greeting-gradient-start) 0%,
            var(--greeting-gradient-mid) 50%,
            var(--greeting-gradient-end) 100%
        );
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        filter: drop-shadow(
            0 2px 8px
                color-mix(in srgb, var(--greeting-gradient-start) 25%, transparent)
        );
    }

    /*
     * New elegant greeting typography
     * Uses serif for warmth, gradient for theme consistency
     */
    .greeting-display {
        @apply text-[2.75rem] leading-[1.1] font-light md:text-[3.5rem];
        font-family: var(--font-outfit), system-ui, sans-serif;
        letter-spacing: -0.03em;
        color: var(--greeting-gradient-mid);
        filter: drop-shadow(
            0 1px 2px
                color-mix(in srgb, var(--greeting-gradient-start) 15%, transparent)
        );
    }

    /* The name gets special serif italic treatment */
    .greeting-name {
        font-family: var(--font-serif), Georgia, serif;
        font-style: italic;
        font-weight: 500;
        letter-spacing: -0.01em;
        background: linear-gradient(
            135deg,
            var(--greeting-gradient-start) 0%,
            var(--greeting-gradient-mid) 50%,
            var(--greeting-gradient-end) 100%
        );
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .greeting-emoji {
        @apply ml-3 inline-block;
        -webkit-text-fill-color: initial;
    }

    /* Name-only greeting: clean, confident */
    .greeting-name-only {
        @apply text-[2.8rem] leading-none font-normal md:text-[3.6rem];
        letter-spacing: -0.03em;
        background: linear-gradient(
            135deg,
            var(--greeting-gradient-start) 0%,
            var(--greeting-gradient-mid) 50%,
            var(--greeting-gradient-end) 100%
        );
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        filter: drop-shadow(
            0 2px 12px color-mix(in srgb, var(--greeting-gradient-mid) 20%, transparent)
        );
    }

    .greeting-wave {
        @apply ml-3 inline-block;
        -webkit-text-fill-color: initial;
        animation: wave 1s ease-in-out forwards;
        transform-origin: 70% 70%;
    }

    @keyframes wave {
        0%,
        100% {
            transform: rotate(0deg);
        }
        10% {
            transform: rotate(14deg);
        }
        20% {
            transform: rotate(-8deg);
        }
        30% {
            transform: rotate(14deg);
        }
        40% {
            transform: rotate(-4deg);
        }
        50% {
            transform: rotate(10deg);
        }
        60%,
        100% {
            transform: rotate(0deg);
        }
    }

    .greeting-subtitle {
        @apply mt-4 text-lg font-light tracking-wide md:text-xl;
        color: var(--greeting-subtitle-color);
        letter-spacing: 0.02em;
        opacity: 0;
        animation: greeting-fade-up 0.6s ease-out forwards;
    }

    /* Entrance animation */
    @keyframes greeting-fade-up {
        from {
            opacity: 0;
            transform: translateY(8px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-greeting-enter {
        animation: greeting-fade-up 0.5s ease-out forwards;
    }

    .animate-greeting-enter .greeting-subtitle {
        animation-delay: 150ms;
    }

    /* Landscape greeting - smaller on height-constrained viewports */
    @media (orientation: landscape) and (max-height: 500px) {
        .greeting-name-only {
            @apply text-[2rem] md:text-[2.4rem];
        }

        .greeting-subtitle {
            @apply mt-2 text-base md:text-lg;
        }
    }
}

/**
 * Mobile Landscape Compact Layout
 *
 * When the viewport is landscape and height-constrained (< 500px),
 * we compress vertical spacing to keep content visible above the fold.
 * This targets mobile landscape without affecting desktop.
 */
@media (orientation: landscape) and (max-height: 500px) {
    /* Header: reduce vertical padding and row spacing while respecting safe areas */
    .landscape-compact-header {
        padding-top: max(0.375rem, env(safe-area-inset-top)) !important;
        padding-bottom: 0.375rem !important;
        gap: 0.25rem !important;
    }

    /* Override Tailwind's space-y-3 in landscape */
    .landscape-compact-header > * + * {
        margin-top: 0.25rem !important;
    }

    /* Viewport: reduce top/bottom padding */
    .landscape-compact-viewport {
        padding-top: 0.25rem !important;
        padding-bottom: 0.5rem !important;
    }

    /* Input container: compress vertical padding while respecting safe areas */
    .landscape-compact-input {
        padding-top: 0.25rem !important;
        padding-bottom: max(0.25rem, env(safe-area-inset-bottom)) !important;
    }

    /* Welcome screen: reduce gap and adjust vertical positioning */
    .landscape-compact-welcome {
        gap: 0.75rem !important;
        justify-content: flex-start !important;
        padding-top: 0.5rem !important;
    }
}

@layer components {
    /*
     * Holographic Markdown Styles
     *
     * These styles target standard HTML elements rendered by react-markdown.
     * The .holo-markdown container scopes all markdown styling.
     */
    .holo-markdown {
        @apply text-foreground/90;
    }

    .holo-markdown > *:first-child {
        @apply mt-0;
    }

    .holo-markdown > *:last-child {
        @apply mb-0;
    }

    /* Paragraphs - more breathing room */
    .holo-markdown p {
        @apply mb-4 leading-relaxed;
    }

    .holo-markdown p:last-child {
        @apply mb-0;
    }

    /* Headings - stronger visual hierarchy */
    .holo-markdown h1 {
        @apply mt-6 mb-4 text-xl font-bold first:mt-0;
    }

    .holo-markdown h2 {
        @apply mt-5 mb-3 text-lg font-bold first:mt-0;
    }

    .holo-markdown h3 {
        @apply mt-4 mb-3 text-base font-semibold first:mt-0;
    }

    .holo-markdown h4 {
        @apply mt-4 mb-2 text-sm font-semibold first:mt-0;
    }

    .holo-markdown h5 {
        @apply mt-3 mb-2 text-sm font-medium first:mt-0;
    }

    .holo-markdown h6 {
        @apply mt-3 mb-2 text-xs font-medium tracking-wide uppercase first:mt-0;
    }

    /* Lists - more breathing room */
    .holo-markdown ul {
        @apply my-4 list-disc space-y-2 pl-6;
    }

    .holo-markdown ol {
        @apply my-4 list-decimal space-y-2 pl-6;
    }

    .holo-markdown ul li,
    .holo-markdown ol li {
        @apply leading-relaxed;
    }

    /* Nested lists tighter spacing */
    .holo-markdown li ul,
    .holo-markdown li ol {
        @apply my-2;
    }

    /* Inline code */
    .holo-markdown code:not(pre code) {
        @apply bg-foreground/10 rounded px-1.5 py-0.5 font-mono text-sm;
    }

    /* Code blocks */
    .holo-markdown pre {
        @apply bg-muted text-foreground my-3 overflow-x-auto rounded-lg p-4 font-mono text-sm;
        backdrop-filter: blur(8px);
    }

    .holo-markdown pre code {
        @apply bg-transparent p-0;
    }

    /* Blockquotes */
    .holo-markdown blockquote {
        @apply border-foreground/20 text-foreground/70 my-3 border-l-2 pl-4 italic;
    }

    /* Links */
    .holo-markdown a {
        @apply text-primary decoration-primary/30 hover:decoration-primary underline transition-colors;
    }

    /* Horizontal rule - stronger visual break */
    .holo-markdown hr {
        @apply border-foreground/20 my-6;
    }

    /* Tables - Enhanced with rounded borders and hover effects */
    .holo-markdown table {
        @apply w-full max-w-full text-sm;
        display: block;
        overflow-x: auto;
    }

    .holo-markdown thead {
        @apply bg-foreground/[0.12];
    }

    .holo-markdown th {
        @apply border-foreground/15 border-b px-4 py-3 text-left font-semibold;
    }

    .holo-markdown th:first-child {
        @apply rounded-tl-lg;
    }

    .holo-markdown th:last-child {
        @apply rounded-tr-lg;
    }

    .holo-markdown tbody tr {
        @apply hover:bg-foreground/[0.02] transition-colors;
    }

    .holo-markdown td {
        @apply border-foreground/10 border-b px-4 py-3;
    }

    .holo-markdown tbody tr:last-child td {
        @apply border-b-0;
    }

    .holo-markdown tbody tr:last-child td:first-child {
        @apply rounded-bl-lg;
    }

    .holo-markdown tbody tr:last-child td:last-child {
        @apply rounded-br-lg;
    }

    /*
     * Code Mode Tool Styles
     *
     * Semantic classes for inline tool displays in code mode.
     * Uses theme-aware colors via CSS variables.
     */

    /* Status colors - semantic naming */
    .tool-status-running {
        @apply text-sky-500;
    }

    .tool-status-success {
        @apply text-emerald-500;
    }

    .tool-status-error {
        @apply text-rose-500;
    }

    /* Tool container base */
    .tool-inline {
        @apply border-foreground/10 bg-muted/50 my-1 overflow-hidden rounded-md border;
    }

    .tool-inline-running {
        @apply border-sky-500/30;
    }

    .tool-inline-error {
        @apply border-rose-500/30;
    }

    /* Tool row - clickable header */
    .tool-inline-row {
        @apply flex w-full items-center gap-2 px-2.5 py-1.5 text-left;
        @apply transition-colors duration-100;
        @apply hover:bg-foreground/[0.03];
    }

    /* Tool output panel */
    .tool-inline-output {
        @apply border-foreground/10 bg-foreground/[0.02] border-t;
    }

    /* Tool error panel */
    .tool-inline-error-panel {
        @apply border-t border-rose-500/20 bg-rose-500/10 px-2.5 py-1.5;
    }

    .tool-inline-error-text {
        @apply font-mono text-xs text-rose-600;
    }

    .dark .tool-inline-error-text {
        @apply text-rose-400;
    }

    /* Status dot animations */
    .tool-status-dot {
        @apply relative flex h-2 w-2 shrink-0;
    }

    .tool-status-dot-running::before {
        content: "";
        @apply absolute h-full w-full animate-ping rounded-full bg-sky-400/50;
    }

    .tool-status-dot-running::after {
        content: "";
        @apply relative inline-flex h-2 w-2 rounded-full;
        background: linear-gradient(135deg, #38bdf8, #0ea5e9);
        box-shadow: 0 1px 2px rgba(14, 165, 233, 0.3);
    }

    .tool-status-dot-success::after {
        content: "";
        @apply relative inline-flex h-2 w-2 rounded-full;
        background: linear-gradient(135deg, #34d399, #10b981);
        box-shadow: 0 1px 2px rgba(16, 185, 129, 0.3);
    }

    .tool-status-dot-error::after {
        content: "";
        @apply relative inline-flex h-2 w-2 rounded-full;
        background: linear-gradient(135deg, #fb7185, #f43f5e);
        box-shadow: 0 1px 2px rgba(244, 63, 94, 0.3);
    }

    /* Tool text styles - theme-aware for readability */
    .tool-name {
        @apply text-foreground shrink-0 font-mono text-xs font-semibold;
    }

    .tool-name-running {
        @apply text-sky-600;
    }

    .dark .tool-name-running {
        @apply text-sky-400;
    }

    .tool-name-error {
        @apply text-rose-600;
    }

    .dark .tool-name-error {
        @apply text-rose-400;
    }

    .tool-summary {
        @apply min-w-0 flex-1 truncate font-mono text-xs;
        color: rgb(107 114 128); /* gray-500 - readable in light mode */
    }

    .dark .tool-summary {
        color: rgb(156 163 175); /* gray-400 - readable in dark mode */
    }

    .tool-result {
        @apply shrink-0 font-mono text-xs font-medium text-emerald-600;
    }

    .dark .tool-result {
        @apply text-emerald-400;
    }

    .tool-output-text {
        @apply font-mono text-xs break-words whitespace-pre-wrap;
        color: rgb(55 65 81); /* gray-700 - readable in light mode */
    }

    .dark .tool-output-text {
        color: rgb(209 213 219); /* gray-300 - readable in dark mode */
    }

    /* Transient activity indicator (streaming status) */
    .tool-transient {
        @apply flex items-center gap-2 rounded-md px-2.5 py-1.5;
        @apply border border-sky-500/20 bg-sky-500/10;
    }

    .tool-transient-text {
        @apply font-mono text-sm text-sky-700;
    }

    .dark .tool-transient-text {
        @apply text-sky-300;
    }
}

@layer utilities {
    /* Custom scrollbar - supports both vertical and horizontal scrolling */
    .scrollbar-holo {
        scrollbar-width: thin;
        scrollbar-color: rgba(139, 102, 184, 0.3) transparent;
    }

    .dark .scrollbar-holo {
        scrollbar-color: rgba(139, 102, 184, 0.3) transparent;
    }

    .scrollbar-holo::-webkit-scrollbar {
        width: 8px;
        height: 8px; /* Enable horizontal scrollbar */
    }

    .scrollbar-holo::-webkit-scrollbar-track {
        background: transparent;
    }

    .scrollbar-holo::-webkit-scrollbar-thumb {
        background: rgba(139, 102, 184, 0.3);
        border-radius: 4px;
    }

    .dark .scrollbar-holo::-webkit-scrollbar-thumb {
        background: rgba(139, 102, 184, 0.3);
    }

    .scrollbar-holo::-webkit-scrollbar-thumb:hover {
        background: rgba(139, 102, 184, 0.5);
    }

    .dark .scrollbar-holo::-webkit-scrollbar-thumb:hover {
        background: rgba(139, 102, 184, 0.5);
    }

    .scrollbar-holo::-webkit-scrollbar-corner {
        background: transparent; /* Clean corner where scrollbars meet */
    }

    /* Hide scrollbar during streaming - content is auto-scrolling anyway */
    .scrollbar-streaming {
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE/Edge */
    }

    .scrollbar-streaming::-webkit-scrollbar {
        display: none; /* Chrome/Safari/Opera */
    }

    /*
     * Chat viewport fade - soft mask on content edges
     *
     * Creates gentle fades where glass panels meet scrolling content:
     * - Top fade (32px): transition from glass header
     * - Bottom fade (40px): transition into glass input dock
     *
     * The fades are fixed pixels, not percentages, ensuring they remain
     * consistent regardless of viewport height. Messages stay readable
     * until near the edge - polish, not visibility blockers.
     *
     * iOS Optimizations:
     * - -webkit-overflow-scrolling: touch enables momentum scrolling
     * - Prevents scroll "stickiness" issues on iOS Safari
     */
    .chat-viewport-fade {
        /* iOS momentum scrolling - critical for natural scroll feel */
        -webkit-overflow-scrolling: touch;

        mask-image: linear-gradient(
            to bottom,
            transparent,
            black var(--chat-fade-top),
            black calc(100% - var(--chat-fade-bottom)),
            transparent
        );
        -webkit-mask-image: linear-gradient(
            to bottom,
            transparent,
            black var(--chat-fade-top),
            black calc(100% - var(--chat-fade-bottom)),
            transparent
        );
    }

    /*
     * Expandable Text Component Styles
     *
     * Used for collapsing long user messages with a blur fade indicator.
     * See knowledge/components/text-expansion.md for design decisions.
     */

    /* Blur gradient fade for truncated content - indicates "there's more below" */
    .expandable-text-fade {
        mask-image: linear-gradient(
            to bottom,
            black 0%,
            black calc(100% - 40px),
            transparent 100%
        );
        -webkit-mask-image: linear-gradient(
            to bottom,
            black 0%,
            black calc(100% - 40px),
            transparent 100%
        );
    }

    /* Dashed frame for expandable text (optional, per spec) */
    .expandable-text-frame {
        @apply rounded-lg border-2 border-dashed p-4;
        border-color: hsl(280 40% 75% / 0.4); /* purple-300 at 40% opacity */
    }

    /* Gentle rotating animation for loading spinner */
    @keyframes spin-slow {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    .animate-spin-slow {
        animation: spin-slow 2s linear infinite;
    }

    /* Subtle shimmer for loading states - GPU accelerated */
    @keyframes shimmer {
        0% {
            background-position: -200% 0;
        }
        100% {
            background-position: 200% 0;
        }
    }

    .animate-shimmer {
        background: linear-gradient(
            90deg,
            hsl(var(--muted) / 0.3) 0%,
            hsl(var(--muted) / 0.5) 50%,
            hsl(var(--muted) / 0.3) 100%
        );
        background-size: 200% 100%;
        animation: shimmer 2s ease-in-out infinite;
    }

    /* Indeterminate progress bar - sweeping gradient for tool execution */
    @keyframes indeterminate-progress {
        0% {
            transform: translateX(-100%);
        }
        100% {
            transform: translateX(100%);
        }
    }

    /*
     * Watermark Presence Animation
     *
     * The background logo emerges from center, growing outward like
     * consciousness expanding into the space. Starts small and blurred,
     * resolving into its full presence with quiet confidence.
     */
    @keyframes watermark-presence {
        0% {
            opacity: 0;
            transform: scale(0.7);
            filter: blur(12px);
        }
        100% {
            opacity: 0.09;
            transform: scale(1);
            filter: blur(0);
        }
    }

    .dark .animate-watermark-presence {
        animation: watermark-presence-dark 1.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    @keyframes watermark-presence-dark {
        0% {
            opacity: 0;
            transform: scale(0.7);
            filter: blur(12px);
        }
        100% {
            opacity: 0.07;
            transform: scale(1);
            filter: blur(0);
        }
    }

    .animate-watermark-presence {
        animation: watermark-presence 1.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    /* Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
        .animate-watermark-presence {
            animation: none;
            opacity: 0.09;
        }
        .dark .animate-watermark-presence {
            animation: none;
            opacity: 0.07;
        }
    }

    /*
     * Oracle Animations
     *
     * Visual states for the Carmenta Oracle icon.
     * These communicate Carmenta's current activity level.
     */

    /* ========== BREATHING ANIMATIONS (10 variations: 5 glow + 5 container) ========== */

    /* ===== GLOW VARIATIONS (1-5) ===== */

    /* Glow 1: Whisper - very subtle, slow */
    @keyframes oracle-breathe-glow-1 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.25;
        }
        50% {
            transform: scale(1.5);
            opacity: 0.55;
        }
    }

    /* Glow 2: Gentle - balanced, soft */
    @keyframes oracle-breathe-glow-2 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.3;
        }
        50% {
            transform: scale(1.8);
            opacity: 0.7;
        }
    }

    /* Glow 3: Warm - more pronounced */
    @keyframes oracle-breathe-glow-3 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.35;
        }
        50% {
            transform: scale(2);
            opacity: 0.85;
        }
    }

    /* Glow 4: Vivid - stronger presence */
    @keyframes oracle-breathe-glow-4 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.4;
        }
        50% {
            transform: scale(2.2);
            opacity: 0.95;
        }
    }

    /* Glow 5: Deep - slow, dramatic */
    @keyframes oracle-breathe-glow-5 {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.2;
        }
        50% {
            transform: scale(2.5);
            opacity: 0.9;
        }
    }

    /* ===== BREATHING: Container "Slow" - centered ±5%, 8.8s ===== */
    /* Scales from 0.95 (exhale) → 1.05 (inhale) → 0.95 - subtle, calming */
    @keyframes oracle-breathe {
        0%,
        100% {
            transform: scale(0.95);
        }
        50% {
            transform: scale(1.05);
        }
    }

    .oracle-breathing {
        animation: oracle-breathe 8.8s ease-in-out infinite;
    }

    /*
     * Watermark sizing - consistent across all pages
     *
     * Creates the immersive "womb" feeling with Carmenta's presence.
     * Uses min() to adapt to viewport while maintaining aspect ratio.
     * 80% of the smaller viewport dimension ensures visibility without overflow.
     */
    .watermark-size {
        width: min(80vh, 80vw);
        height: min(80vh, 80vw);
    }

    /* ===== WORKING: Rainbow + Glow "Slow" - 3s ===== */
    @keyframes oracle-rainbow-spin {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    @keyframes oracle-rainbow-glow {
        0%,
        100% {
            transform: scale(1);
            opacity: 0.4;
        }
        50% {
            transform: scale(1.8);
            opacity: 0.9;
        }
    }

    .oracle-working-glow {
        animation: oracle-rainbow-glow 3s ease-in-out infinite;
    }

    .oracle-working-ring {
        animation: oracle-rainbow-spin 3s linear infinite;
    }

    /* ========== NOTIFICATION ANIMATIONS (5 distinct styles) ========== */

    /* N1: Expanding rings - concentric circles pulse outward */
    @keyframes oracle-ring-expand {
        0% {
            transform: scale(1);
            opacity: 1;
        }
        100% {
            transform: scale(2.5);
            opacity: 0;
        }
    }

    /* N2: Pop bounce - icon pops up and bounces */
    @keyframes oracle-pop {
        0% {
            transform: scale(1);
        }
        30% {
            transform: scale(1.3);
        }
        50% {
            transform: scale(0.95);
        }
        70% {
            transform: scale(1.1);
        }
        100% {
            transform: scale(1);
        }
    }

    /* N3: Sparkle burst - particles explode outward */
    @keyframes oracle-sparkle-out {
        0% {
            transform: translateX(0) scale(1);
            opacity: 1;
        }
        100% {
            transform: translateX(var(--sparkle-distance)) scale(0);
            opacity: 0;
        }
    }

    /* N4: Glow flash - bright flash then settle */
    @keyframes oracle-flash {
        0% {
            opacity: 0;
            transform: scale(0.8);
        }
        20% {
            opacity: 1;
            transform: scale(2);
        }
        100% {
            opacity: 0.3;
            transform: scale(1.5);
        }
    }

    /* N5: Shake/wiggle - attention grabbing shake */
    @keyframes oracle-shake {
        0%,
        100% {
            transform: rotate(0deg);
        }
        10% {
            transform: rotate(-8deg);
        }
        20% {
            transform: rotate(8deg);
        }
        30% {
            transform: rotate(-6deg);
        }
        40% {
            transform: rotate(6deg);
        }
        50% {
            transform: rotate(-4deg);
        }
        60% {
            transform: rotate(4deg);
        }
        70% {
            transform: rotate(-2deg);
        }
        80% {
            transform: rotate(2deg);
        }
        90% {
            transform: rotate(0deg);
        }
    }

    /* Shared notify glow */
    @keyframes oracle-notify-glow {
        0% {
            transform: scale(1);
            opacity: 0.3;
        }
        30% {
            transform: scale(1.6);
            opacity: 1;
        }
        100% {
            transform: scale(1.2);
            opacity: 0.5;
        }
    }

    /* =============================================
     * Apple-Quality Tap Feedback System
     * =============================================
     * iOS-native-feeling tap feedback that combines:
     * - Subtle, fast ripple (Material-inspired but Apple-tuned)
     * - Scale feedback on tap
     * - Haptic integration (handled via JS)
     *
     * Philosophy:
     * - < 100ms: Feels instant (Apple HIG)
     * - Subtle over flashy (iOS restraint)
     * - Graceful degradation
     * - Respects prefers-reduced-motion
     */

    /* Ripple expansion animation - fast, subtle, Apple-quality */
    @keyframes tap-ripple-expand {
        0% {
            transform: scale(0);
            opacity: 0.4;
        }
        50% {
            opacity: 0.2;
        }
        100% {
            transform: scale(1);
            opacity: 0;
        }
    }

    /* Tap target base - ensures proper positioning for ripple */
    .tap-target {
        position: relative;
        overflow: hidden;
        /* iOS: Remove default tap highlight, we provide our own */
        -webkit-tap-highlight-color: transparent;
        /* Faster taps - no 300ms delay */
        touch-action: manipulation;
        /* GPU acceleration for smooth animations */
        will-change: transform;
        /* Smooth transitions */
        transition: transform 0.15s cubic-bezier(0.2, 0, 0.2, 1);
    }

    /* Active state scale - the "press" feel */
    .tap-target:active {
        transform: scale(0.97);
    }

    /* Hover only on devices that support hover (not touch) */
    @media (hover: hover) and (pointer: fine) {
        .tap-target:hover {
            transform: scale(1.02);
        }
        .tap-target:active {
            transform: scale(0.97);
        }
    }

    /* Touch-only devices - no hover, just press */
    @media (hover: none) {
        .tap-target:hover {
            transform: none;
        }
    }

    /* Tap target variants */
    .tap-target-subtle:active {
        transform: scale(0.98);
    }

    .tap-target-deep:active {
        transform: scale(0.95);
    }

    /* Icon tap target - deeper press for icon buttons */
    .tap-icon {
        position: relative;
        overflow: hidden;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
        will-change: transform;
        transition: transform 0.12s cubic-bezier(0.2, 0, 0.2, 1);
    }

    .tap-icon:active {
        transform: scale(0.92);
    }

    @media (hover: hover) and (pointer: fine) {
        .tap-icon:hover {
            transform: scale(1.08);
        }
        .tap-icon:active {
            transform: scale(0.92);
        }
    }

    /* Pill/chip tap target - for suggestion chips, tags */
    .tap-pill {
        position: relative;
        overflow: hidden;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
        will-change: transform;
        transition:
            transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
            background-color 0.15s ease;
    }

    .tap-pill:active {
        transform: scale(0.96);
    }

    @media (hover: hover) and (pointer: fine) {
        .tap-pill:hover {
            transform: scale(1.03);
        }
        .tap-pill:active {
            transform: scale(0.96);
        }
    }

    /* Reduced motion: disable scale animations, keep feedback via opacity */
    @media (prefers-reduced-motion: reduce) {
        .tap-target,
        .tap-target-subtle,
        .tap-target-deep,
        .tap-icon,
        .tap-pill {
            transition: opacity 0.1s ease;
            will-change: opacity;
        }

        .tap-target:active,
        .tap-target-subtle:active,
        .tap-target-deep:active,
        .tap-icon:active,
        .tap-pill:active {
            transform: none;
            opacity: 0.7;
        }

        .tap-target:hover,
        .tap-icon:hover,
        .tap-pill:hover {
            transform: none;
        }
    }

    /* Legacy ripple effect for button clicks (centered) */
    @keyframes ripple {
        0% {
            transform: translate(-50%, -50%) scale(0);
            opacity: 0.6;
        }
        100% {
            transform: translate(-50%, -50%) scale(10);
            opacity: 0;
        }
    }

    .animate-ripple {
        animation: ripple 0.6s ease-out;
    }

    /*
     * Pipeline Status Animations
     *
     * Visual feedback for LLM pipeline stages:
     * - Concierge selecting (sparkle pulse)
     * - Model selected (flash entrance)
     * - Response complete (success pulse)
     */

    /* Sparkle pulse: gentle scale + rotation for concierge "selecting" state */
    @keyframes sparkle-pulse {
        0%,
        100% {
            opacity: 0.5;
            transform: scale(1) rotate(0deg);
        }
        50% {
            opacity: 1;
            transform: scale(1.15) rotate(15deg);
        }
    }

    .animate-sparkle-pulse {
        animation: sparkle-pulse 1.2s ease-in-out infinite;
    }

    /* Success pulse: brief glow ring on completion */
    @keyframes success-pulse {
        0% {
            box-shadow: 0 0 0 0 hsl(var(--primary) / 0.6);
        }
        50% {
            box-shadow: 0 0 0 8px hsl(var(--primary) / 0);
        }
        100% {
            box-shadow: 0 0 0 0 hsl(var(--primary) / 0);
        }
    }

    .animate-success-pulse {
        animation: success-pulse 400ms ease-out;
    }

    /* Concierge selecting shimmer - horizontal sweep */
    @keyframes selecting-shimmer {
        0% {
            background-position: -200% 0;
        }
        100% {
            background-position: 200% 0;
        }
    }

    .animate-selecting-shimmer {
        background: linear-gradient(
            90deg,
            hsl(var(--primary) / 0.1) 0%,
            hsl(var(--primary) / 0.3) 50%,
            hsl(var(--primary) / 0.1) 100%
        );
        background-size: 200% 100%;
        animation: selecting-shimmer 1.5s ease-in-out infinite;
    }

    /* Reduced motion: disable all pipeline animations */
    @media (prefers-reduced-motion: reduce) {
        .animate-sparkle-pulse,
        .animate-success-pulse,
        .animate-selecting-shimmer {
            animation: none;
        }
        .animate-sparkle-pulse {
            opacity: 1;
        }
    }

    /* Breath-like transition for organic, calming movement
     * Uses a custom cubic-bezier that mirrors natural breathing rhythm:
     * slow start → accelerate → slow end (like exhale → pause → inhale) */
    .transition-breathe {
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Exit animation: gentle upward drift like breath releasing */
    .breathe-exit {
        transition:
            opacity 600ms cubic-bezier(0.4, 0, 0.2, 1),
            transform 600ms cubic-bezier(0.4, 0, 0.2, 1),
            filter 600ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Enter animation: settling down like breath arriving */
    .breathe-enter {
        transition:
            opacity 500ms cubic-bezier(0.2, 0.8, 0.2, 1),
            transform 500ms cubic-bezier(0.2, 0.8, 0.2, 1),
            filter 500ms cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    /* Shake animation for errors */
    @keyframes shake {
        0%,
        100% {
            transform: translateX(0);
        }
        25% {
            transform: translateX(-8px);
        }
        75% {
            transform: translateX(8px);
        }
    }

    /* Carmenta Glass System - DRY glassmorphism using CSS variables */

    /* Glass background utilities - auto-switch between light/dark */
    .glass-bg {
        background: var(--glass-bg);
    }

    .glass-bg-hover:hover {
        background: var(--glass-bg-hover);
    }

    .glass-bg-active {
        background: var(--glass-bg-active);
    }

    .glass-surface {
        background: var(--glass-surface);
    }

    .glass-shadow {
        box-shadow: var(--glass-shadow);
    }

    /* Glass container - for popovers, dropdowns, panels */
    .glass-container {
        background: var(--glass-surface);
        box-shadow: var(--glass-shadow);
        @apply ring-1 ring-white/40 backdrop-blur-xl;
    }

    .dark .glass-container {
        @apply ring-white/15;
    }

    /*
     * Mobile-solid glass variant for dropdown menus
     * iOS Safari PWA has unreliable backdrop-blur support, causing content bleed-through.
     * This provides a fully opaque background on mobile for critical UI like menus.
     */
    .glass-container-mobile {
        background: var(--glass-surface);
        box-shadow: var(--glass-shadow);
        @apply ring-1 ring-white/40 backdrop-blur-xl;
    }

    .dark .glass-container-mobile {
        @apply ring-white/15;
    }

    /* On mobile (touch devices), use fully opaque backgrounds */
    @media (max-width: 768px), (pointer: coarse) {
        .glass-container-mobile {
            background: hsl(var(--background));
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
        }
    }

    /* Fallback for browsers that don't support backdrop-filter */
    @supports not (backdrop-filter: blur(1px)) {
        .glass-container,
        .glass-container-mobile {
            background: hsl(var(--background));
        }
    }

    /* Glass pill - for buttons in glass containers (e.g., connection chooser) */
    .glass-pill {
        background: var(--glass-bg);
        box-shadow: var(--glass-shadow);
        @apply ring-foreground/15 rounded-xl ring-1 backdrop-blur-xl;
        @apply transition-all duration-200;
    }

    .glass-pill:hover {
        background: var(--glass-bg-hover);
        @apply ring-foreground/20 shadow-2xl;
    }

    .dark .glass-pill {
        @apply ring-white/15;
    }

    /* Carmenta Button States - Centralized interaction patterns */

    /* Glass button base - uses CSS variables
     * Light mode: enhanced contrast with stronger ring and shadow for affordance
     * Dark mode: subtle glow effect */
    .btn-glass {
        @apply flex items-center justify-center rounded-full;
        background: var(--glass-bg);
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.12),
            0 1px 2px rgba(0, 0, 0, 0.06);
        @apply ring-foreground/20 ring-1 backdrop-blur-xl;
        @apply transition-all duration-300;
    }

    .dark .btn-glass {
        @apply ring-white/20;
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.25);
    }

    /* ==========================================================================
       Interactive State Primitives
       Composable focus, hover, and press states for all interactive elements.
       Use focus-visible for keyboard-only focus rings (a11y best practice).
       ========================================================================== */

    /* Focus ring - primary (default) */
    .interactive-focus {
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
    }

    /* Focus ring - with offset for solid background buttons */
    .interactive-focus-offset {
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:ring-offset-2 focus-visible:outline-none;
    }

    /* Focus ring - amber for starred/warning elements */
    .interactive-focus-amber {
        @apply focus-visible:ring-[3px] focus-visible:ring-amber-300/50 focus-visible:outline-none;
    }

    /* Focus ring - red for destructive actions */
    .interactive-focus-destructive {
        @apply focus-visible:ring-[3px] focus-visible:ring-red-300/50 focus-visible:outline-none;
    }

    /* Focus ring - muted for secondary/subtle elements */
    .interactive-focus-muted {
        @apply focus-visible:ring-foreground/20 focus-visible:ring-[3px] focus-visible:outline-none;
    }

    /* Press state - subtle scale for most buttons */
    .interactive-press {
        @apply active:scale-[0.98];
    }

    /* Press state - deeper scale for icon buttons */
    .interactive-press-icon {
        @apply active:scale-[0.92];
    }

    /* Press state - depth shift for solid buttons (translate + shadow) */
    .interactive-press-depth {
        @apply active:translate-y-0.5 active:shadow-sm;
    }

    /* ==========================================================================
       Glass Button States
       For buttons with glassmorphism treatment.
       ========================================================================== */

    /* Click state - Ripple + depth shift */
    .btn-clickable {
        @apply active:translate-y-0.5 active:shadow-sm;
    }

    /* Hover state - Scale + shadow + ring */
    .btn-hoverable {
        @apply hover:ring-primary/40 hover:scale-105 hover:shadow-2xl hover:ring-[3px];
    }

    .btn-hoverable:hover {
        background: var(--glass-bg-hover);
    }

    /* Focus state - Scale + shadow + ring (keyboard navigation) */
    .btn-focusable {
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
        @apply focus-visible:scale-105 focus-visible:shadow-2xl;
    }

    /* Disabled state - Grayscale */
    .btn-disabled {
        @apply cursor-not-allowed opacity-50 grayscale;
    }

    /* Complete glass button with all states */
    .btn-glass-interactive {
        /* btn-glass */
        @apply flex items-center justify-center rounded-full;
        background: var(--glass-bg);
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.12),
            0 1px 2px rgba(0, 0, 0, 0.06);
        @apply ring-foreground/20 ring-1 backdrop-blur-xl;
        @apply transition-all duration-300;
        /* btn-clickable */
        @apply active:translate-y-0.5 active:shadow-sm;
        /* btn-hoverable */
        @apply hover:ring-primary/40 hover:scale-105 hover:shadow-2xl hover:ring-[3px];
        /* btn-focusable */
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
        @apply focus-visible:scale-105 focus-visible:shadow-2xl;
    }

    .dark .btn-glass-interactive {
        @apply ring-white/20;
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.25);
    }

    .btn-glass-interactive:hover {
        background: var(--glass-bg-hover);
    }

    /* Icon button variant */
    .btn-icon-glass {
        /* btn-glass-interactive (inlined) */
        @apply flex items-center justify-center rounded-full;
        background: var(--glass-bg);
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.12),
            0 1px 2px rgba(0, 0, 0, 0.06);
        @apply ring-foreground/20 ring-1 backdrop-blur-xl;
        @apply transition-all duration-300;
        @apply active:translate-y-0.5 active:shadow-sm;
        @apply hover:ring-primary/40 hover:scale-105 hover:shadow-2xl hover:ring-[3px];
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
        @apply focus-visible:scale-105 focus-visible:shadow-2xl;
        /* size */
        @apply h-11 w-11 sm:h-12 sm:w-12;
    }

    .dark .btn-icon-glass {
        @apply ring-white/20;
        box-shadow:
            var(--glass-shadow),
            0 2px 8px rgba(0, 0, 0, 0.25);
    }

    .btn-icon-glass:hover {
        background: var(--glass-bg-hover);
    }

    /* ==========================================================================
       Subtle Buttons
       For buttons inside glass containers. Lighter treatment since they're
       already in a glass context.
       ========================================================================== */

    /* Base subtle button */
    .btn-subtle {
        @apply rounded-md transition-all;
        @apply hover:ring-primary/30 hover:ring-[3px];
        /* interactive-focus */
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
        /* interactive-press */
        @apply active:scale-[0.98];
    }

    .btn-subtle:hover,
    .btn-subtle:focus-visible {
        background: var(--glass-bg-hover);
    }

    /* Subtle icon button - small icons with deeper press */
    .btn-subtle-icon {
        /* btn-subtle (inlined) */
        @apply rounded-md p-1 transition-all;
        @apply hover:ring-primary/30 hover:ring-[3px];
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
        @apply hover:scale-110 focus-visible:scale-110;
        /* interactive-press-icon */
        @apply active:scale-[0.92];
    }

    .btn-subtle-icon:hover,
    .btn-subtle-icon:focus-visible {
        background: var(--glass-bg-hover);
    }

    /* Subtle text button - for text/label buttons */
    .btn-subtle-text {
        /* btn-subtle (inlined) */
        @apply rounded-md px-2 py-1 transition-all;
        @apply hover:ring-primary/30 hover:ring-[3px];
        @apply focus-visible:ring-primary/40 focus-visible:ring-[3px] focus-visible:outline-none;
        @apply active:scale-[0.98];
        @apply hover:scale-105 focus-visible:scale-105;
    }

    .btn-subtle-text:hover,
    .btn-subtle-text:focus-visible {
        background: var(--glass-bg-hover);
    }

    /*
     * View Transitions (React 19 + next-view-transitions)
     *
     * Smooth page transitions that match Carmenta's ethereal motion design.
     * Uses the same timing curves as our watermark-presence animation for
     * consistency across all motion in the interface.
     */
    @supports (view-transition-name: none) {
        /* Global transition timing - matches Carmenta's motion language */
        ::view-transition-group(*) {
            animation-duration: 400ms;
            animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* Old content fades and scales down slightly */
        ::view-transition-old(*) {
            animation: view-fade-out 400ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* New content fades in and scales up from slightly smaller */
        ::view-transition-new(*) {
            animation: view-fade-in 400ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes view-fade-out {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.98);
            }
        }

        @keyframes view-fade-in {
            from {
                opacity: 0;
                transform: scale(1.02);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Named view transitions for persistent elements */
        .vt-app-logo {
            view-transition-name: app-logo;
        }

        .vt-oracle-home {
            view-transition-name: oracle-home;
        }

        .vt-theme-switcher {
            view-transition-name: theme-switcher;
        }

        .vt-user-auth {
            view-transition-name: user-auth;
        }

        /* Persistent elements morph position without fade animation */
        ::view-transition-group(app-logo),
        ::view-transition-group(oracle-home),
        ::view-transition-group(theme-switcher),
        ::view-transition-group(user-auth) {
            animation-duration: 350ms;
        }

        /* Disable fade for persistent elements - they should only morph */
        ::view-transition-old(app-logo),
        ::view-transition-new(app-logo),
        ::view-transition-old(oracle-home),
        ::view-transition-new(oracle-home),
        ::view-transition-old(theme-switcher),
        ::view-transition-new(theme-switcher),
        ::view-transition-old(user-auth),
        ::view-transition-new(user-auth) {
            animation: none;
        }
    }

    .tooltip::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: calc(100% + 8px);
        left: 50%;
        transform: translateX(-50%) translateY(4px);
        padding: 8px 14px;
        border-radius: 8px; /* rounded-lg */
        background: hsl(var(--background) / 0.85);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid hsl(var(--foreground) / 0.1);
        color: hsl(var(--foreground) / 0.9);
        font-size: 12px;
        font-weight: 500;
        line-height: 1;
        white-space: nowrap;
        pointer-events: none;
        opacity: 0;
        z-index: var(--z-tooltip);
        transition:
            opacity 200ms ease-out,
            transform 200ms ease-out;
    }

    .tooltip:hover::after,
    .tooltip:focus::after {
        opacity: 1;
        transform: translateX(-50%) translateY(-4px);
    }

    /* Hide tooltip when empty */
    .tooltip[data-tooltip=""]::after {
        display: none;
    }

    /* Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
        ::view-transition-group(*),
        ::view-transition-old(*),
        ::view-transition-new(*) {
            animation: none !important;
        }
    }

    /* =============================================
     * Holographic Background V2 - CSS Animations
     * =============================================
     * Pure CSS blob drift animations. Each blob has a unique
     * movement path with prime-ish durations to prevent sync.
     */

    /* Blob drift animations - organic, slow movement patterns */
    @keyframes drift-1 {
        0% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
        25% {
            transform: translate(-50%, -50%) translate(80px, -40px);
        }
        50% {
            transform: translate(-50%, -50%) translate(40px, 60px);
        }
        75% {
            transform: translate(-50%, -50%) translate(-60px, 20px);
        }
        100% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
    }

    @keyframes drift-2 {
        0% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
        33% {
            transform: translate(-50%, -50%) translate(-70px, 50px);
        }
        66% {
            transform: translate(-50%, -50%) translate(50px, -30px);
        }
        100% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
    }

    @keyframes drift-3 {
        0% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
        20% {
            transform: translate(-50%, -50%) translate(60px, 40px);
        }
        40% {
            transform: translate(-50%, -50%) translate(-40px, 80px);
        }
        60% {
            transform: translate(-50%, -50%) translate(-80px, -20px);
        }
        80% {
            transform: translate(-50%, -50%) translate(30px, -50px);
        }
        100% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
    }

    @keyframes drift-4 {
        0% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
        50% {
            transform: translate(-50%, -50%) translate(-90px, -60px);
        }
        100% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
    }

    @keyframes drift-5 {
        0% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
        25% {
            transform: translate(-50%, -50%) translate(-50px, 70px);
        }
        50% {
            transform: translate(-50%, -50%) translate(70px, 50px);
        }
        75% {
            transform: translate(-50%, -50%) translate(40px, -60px);
        }
        100% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
    }

    @keyframes drift-6 {
        0% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
        33% {
            transform: translate(-50%, -50%) translate(100px, 0);
        }
        66% {
            transform: translate(-50%, -50%) translate(-30px, -70px);
        }
        100% {
            transform: translate(-50%, -50%) translate(0, 0);
        }
    }

    /* Hue cycle - smooth color rotation */
    @keyframes hue-cycle {
        from {
            filter: blur(40px) hue-rotate(0deg);
        }
        to {
            filter: blur(40px) hue-rotate(360deg);
        }
    }

    /* Star twinkle - gentle opacity pulse */
    @keyframes twinkle {
        0%,
        100% {
            opacity: 0.3;
        }
        50% {
            opacity: 0.9;
        }
    }

    /* Reduced motion: simplify holographic animations */
    @media (prefers-reduced-motion: reduce) {
        [class*="drift-"],
        .hue-cycle {
            animation: none !important;
        }
        @keyframes twinkle {
            0%,
            100% {
                opacity: 0.5;
            }
        }
    }
}
