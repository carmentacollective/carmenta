@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * Holographic Dream Theme
 *
 * Design tokens and utility classes for Carmenta's visual language.
 * No !important hacks - we use headless primitives instead of fighting
 * pre-styled components.
 */

@layer base {
    :root {
        /* Background & Surface */
        --background: 320 20% 97%; /* #F8F4F8 */
        --foreground: 285 25% 31%;

        --card: 0 0% 100%;
        --card-foreground: 285 25% 31%;

        --popover: 0 0% 100%;
        --popover-foreground: 285 25% 31%;

        /* Primary - Holographic accent */
        --primary: 280 40% 75%;
        --primary-foreground: 0 0% 100%;

        /* Secondary */
        --secondary: 280 20% 95%;
        --secondary-foreground: 285 25% 31%;

        /* Muted */
        --muted: 280 20% 92%;
        --muted-foreground: 285 20% 50%;

        /* Accent */
        --accent: 280 30% 88%;
        --accent-foreground: 285 25% 31%;

        /* Destructive */
        --destructive: 0 60% 70%;
        --destructive-foreground: 0 0% 100%;

        /* Borders & Inputs */
        --border: 280 20% 85%;
        --input: 280 20% 90%;
        --ring: 280 40% 75%;

        /* Border radius */
        --radius: 0.75rem;

        /* Glassmorphism */
        --glass-blur: 24px;
    }

    .dark {
        --background: 280 30% 8%;
        --foreground: 280 20% 90%;

        --card: 280 30% 12%;
        --card-foreground: 280 20% 90%;

        --popover: 280 30% 10%;
        --popover-foreground: 280 20% 90%;

        --primary: 280 50% 65%;
        --primary-foreground: 280 30% 8%;

        --secondary: 280 20% 20%;
        --secondary-foreground: 280 20% 90%;

        --muted: 280 20% 18%;
        --muted-foreground: 280 15% 60%;

        --accent: 280 25% 20%;
        --accent-foreground: 280 20% 90%;

        --destructive: 0 50% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 280 20% 25%;
        --input: 280 20% 20%;
        --ring: 280 50% 65%;
    }
}

@layer base {
    * {
        @apply border-border;
    }

    html {
        /* Smooth scrolling for in-page navigation */
        scroll-behavior: smooth;

        /* Prevent text size adjustment on orientation change */
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;

        /* Better tap behavior on iOS */
        -webkit-tap-highlight-color: transparent;
    }

    /* Respect user motion preferences */
    @media (prefers-reduced-motion: reduce) {
        html {
            scroll-behavior: auto;
        }
    }

    body {
        @apply bg-background text-foreground;
        font-feature-settings:
            "rlig" 1,
            "calt" 1;
    }
}

@layer components {
    /* Glassmorphism card */
    .glass-card {
        @apply rounded-2xl p-6;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        box-shadow:
            0 8px 32px rgba(180, 140, 200, 0.2),
            0 0 0 1px rgba(255, 255, 255, 0.6),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .dark .glass-card {
        background: rgba(40, 30, 50, 0.6);
        box-shadow:
            0 8px 32px rgba(100, 80, 120, 0.3),
            0 0 0 1px rgba(255, 255, 255, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    /* User message bubble with holographic gradient */
    .user-message-bubble {
        background: linear-gradient(
            135deg,
            rgba(200, 160, 220, 0.3),
            rgba(160, 200, 220, 0.3)
        );
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }

    .dark .user-message-bubble {
        background: linear-gradient(
            135deg,
            rgba(160, 120, 180, 0.4),
            rgba(120, 160, 180, 0.4)
        );
    }

    /* Assistant message bubble with glass effect */
    .assistant-message-bubble {
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
    }

    .dark .assistant-message-bubble {
        background: rgba(60, 50, 70, 0.6);
    }

    /* Error message bubble */
    .error-message-bubble {
        background: rgba(220, 38, 38, 0.1);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }

    .dark .error-message-bubble {
        background: rgba(180, 30, 30, 0.2);
    }

    /* Glassmorphism input dock */
    .glass-input-dock {
        @apply rounded-[28px] p-2;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        box-shadow:
            0 8px 32px rgba(180, 140, 200, 0.2),
            0 0 0 1px rgba(255, 255, 255, 0.6),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    /* Holographic gradient button */
    .btn-holo {
        @apply relative inline-flex items-center justify-center rounded-full px-6 py-3 text-sm font-medium text-white transition-all;
        background: linear-gradient(
            135deg,
            rgba(200, 160, 220, 0.9) 0%,
            rgba(160, 200, 220, 0.9) 50%,
            rgba(220, 180, 200, 0.9) 100%
        );
        box-shadow: 0 4px 16px rgba(180, 140, 200, 0.3);
    }

    .btn-holo:hover {
        @apply scale-105;
        box-shadow: 0 8px 24px rgba(180, 140, 200, 0.4);
    }

    /* Greeting text styles */
    .greeting-title {
        @apply text-4xl font-light tracking-tight md:text-5xl;
        color: rgba(90, 60, 100, 0.85);
        letter-spacing: -1.5px;
        text-shadow: 0 2px 20px rgba(255, 255, 255, 0.5);
    }

    .greeting-subtitle {
        @apply text-base;
        color: rgba(120, 90, 130, 0.8);
    }
}

@layer components {
    /*
     * Holographic Markdown Styles
     *
     * These styles target class names from @assistant-ui/react-ui (v0.2.x).
     * The .aui-md-* classes are generated by makeMarkdownText().
     * If upgrading assistant-ui, verify these class names still match.
     */
    .holo-markdown {
        @apply text-foreground/90;
    }

    .holo-markdown > *:first-child {
        @apply mt-0;
    }

    .holo-markdown > *:last-child {
        @apply mb-0;
    }

    /* Paragraphs */
    .holo-markdown .aui-md-p {
        @apply mb-3;
    }

    .holo-markdown .aui-md-p:last-child {
        @apply mb-0;
    }

    /* Headings */
    .holo-markdown .aui-md-h1 {
        @apply mb-3 mt-4 text-xl font-semibold first:mt-0;
    }

    .holo-markdown .aui-md-h2 {
        @apply mb-2 mt-3 text-lg font-semibold first:mt-0;
    }

    .holo-markdown .aui-md-h3 {
        @apply mb-2 mt-3 text-base font-semibold first:mt-0;
    }

    .holo-markdown .aui-md-h4 {
        @apply mb-2 mt-3 text-sm font-semibold first:mt-0;
    }

    .holo-markdown .aui-md-h5 {
        @apply mb-1 mt-2 text-sm font-medium first:mt-0;
    }

    .holo-markdown .aui-md-h6 {
        @apply mb-1 mt-2 text-xs font-medium uppercase tracking-wide first:mt-0;
    }

    /* Lists */
    .holo-markdown .aui-md-ul {
        @apply my-2 list-disc space-y-1 pl-5;
    }

    .holo-markdown .aui-md-ol {
        @apply my-2 list-decimal space-y-1 pl-5;
    }

    .holo-markdown .aui-md-ul li,
    .holo-markdown .aui-md-ol li {
        @apply leading-relaxed;
    }

    /* Inline code */
    .holo-markdown .aui-md-inline-code {
        @apply rounded bg-foreground/10 px-1.5 py-0.5 font-mono text-sm;
    }

    /* Code blocks */
    .holo-markdown .aui-md-pre {
        @apply my-3 overflow-x-auto rounded-lg bg-foreground/10 p-4 font-mono text-sm;
        backdrop-filter: blur(8px);
    }

    /* Blockquotes */
    .holo-markdown .aui-md-blockquote {
        @apply my-3 border-l-2 border-foreground/20 pl-4 italic text-foreground/70;
    }

    /* Links */
    .holo-markdown .aui-md-a {
        @apply text-primary underline decoration-primary/30 transition-colors hover:decoration-primary;
    }

    /* Horizontal rule */
    .holo-markdown .aui-md-hr {
        @apply my-4 border-foreground/10;
    }

    /* Tables */
    .holo-markdown .aui-md-table {
        @apply my-3 w-full border-collapse text-sm;
    }

    .holo-markdown .aui-md-th {
        @apply border-b border-foreground/20 p-2 text-left font-semibold;
    }

    .holo-markdown .aui-md-td {
        @apply border-b border-foreground/10 p-2;
    }
}

@layer utilities {
    /* Custom scrollbar */
    .scrollbar-holo {
        scrollbar-width: thin;
        scrollbar-color: rgba(180, 140, 200, 0.3) transparent;
    }

    .scrollbar-holo::-webkit-scrollbar {
        width: 8px;
    }

    .scrollbar-holo::-webkit-scrollbar-track {
        background: transparent;
    }

    .scrollbar-holo::-webkit-scrollbar-thumb {
        background: rgba(180, 140, 200, 0.3);
        border-radius: 4px;
    }

    .scrollbar-holo::-webkit-scrollbar-thumb:hover {
        background: rgba(180, 140, 200, 0.5);
    }

    /* Gentle rotating animation for loading spinner */
    @keyframes spin-slow {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    .animate-spin-slow {
        animation: spin-slow 2s linear infinite;
    }
}
